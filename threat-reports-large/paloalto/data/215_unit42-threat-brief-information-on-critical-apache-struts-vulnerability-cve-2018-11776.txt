Situation Overview On August 22, 2018, the Apache Foundation released a critical security update for CVE-2018-1176, a remote code execution vulnerability affecting Apache Struts versions 2.3 to 2.3.34 and 2.5 to 2.5.16.
The Apache Foundation has urged everyone to apply the security updates as soon as possible.
This blog is to provide information to help organizations assess their risk of the vulnerability and to inform Palo Alto Networks customers of protections in place that can help mitigate their risk until they can apply the security updates.
Palo Alto Networks customers who have deployed the latest vulnerability signatures released on August 24, 2018, are protected.
Vulnerability Information According to both the Apache Foundation and security researcher Man Yue Mo, this vulnerability can enable remote code execution on a server running a vulnerable version of Apache Struts.
The method of attack would be through a specially crafted URL sent to the vulnerable system.
In most cases, this means no authentication is required to exploit the vulnerability.
A successful attack would run code in the security context that Struts is using.
In some cases, this could effectively lead to a total compromise of the system.
It’s important to note, however, that the vulnerability is not exploitable in default configurations.
The following two conditions must both be met for a system to be vulnerable to attack:
The alwaysSelectFullNamespace flag is set to “true” in the Struts configuration.
(Note: If your application uses the popular Struts Convention plugin this is set to “true” by default by the plugin.
The Struts application uses “actions” that are configured without specifying a namespace, or with a wildcard namespace.
This condition applies to actions and namespaces specified in the Struts configuration file .
NOTE: your application uses the popular Struts Convention plugin this condition also applies to actions and namespaces specified in Java code.
If your Struts application does not meet both of these conditions, your application may still be vulnerable but not (currently) exploitable via CVE-2018-11776.
In particular, if your application uses the popular Struts Convention plugin, it appears to potentially increase your risk of exploitability vis-à-vis other Struts implementations that do not use that plugin.
Threat Environment Information The vulnerability was disclosed on August 22 in conjunction with security updates that address it.
There is detailed information about the vulnerability and how to exploit it available currently.
There is also proof of concept (PoC) code available already.
As noted above, the PoC works only against systems that are vulnerable and meet both conditions for exploitability.
Some have noted that a previous critical Struts vulnerability was actively attacked last year only three days after the release of the security update and vulnerability information.
There are no known active attacks at this time and the current requirement that two, non-default conditions need to be met for the vulnerability to be exploitable makes for a different threat environment.
However with active PoC available we can expect at the minimum probing, if not active exploitation of this vulnerability in the near term.
Organizations should focus their risk assessments for possible attack until they can patch on four things:
Are they using the Struts Convention plugin?
Do they meet both of the required conditions for exploitation?
Any weaponization or indication of attacks using the current PoC
Developments of new PoC or attacks that render moot the two conditions required for exploitability?
Guidance and Protections for Palo Alto Networks Customers All organizations running vulnerable versions of Apache Struts should deploy the security updates as soon as possible.
Organizations can and should prioritize scheduling and deployment of the security updates based on their security policy and risk assessment, and on currently available information.
Palo Alto Networks customers who have deployed vulnerability signatures in content release version 8057 released on August 24, 2018, which include ID 33948 Name: Apache Struts 2 Remote Code Execution Vulnerability, are protected against currently known exploits against that vulnerability.
Our customers should still deploy the security update as recommended above, but can and should deploy the latest vulnerability signature immediate for additional protection.
With this addition protection available, our customers can and should include that as part of their decisions around security and deployment of the security updates and their risk assessment of the vulnerability and threat environment.
As always, we are monitoring the situation closely and will provide additional details as they become available.
