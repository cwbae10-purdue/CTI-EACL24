Executive Summary
Palo Alto Networks Unit 42 has been tracking the evolution of the Mirai malware, known for targeting embedded devices with the primary intent of launching DDoS attacks and self-propagation, since 2016 when it took down several notable targets.
As part of this ongoing research, we’ve recently discovered a new variant of Mirai that has eight new exploits against a wide range of embedded devices.
These newly targeted devices range from wireless presentation systems to set-top-boxes, SD-WANs, and even smart home controllers.
Mirai initially made use of default credentials to gain access to devices.
However, since the end of 2017, samples of the family have increasingly been observed making use of publicly available exploits to propagate and run on vulnerable devices.
2018 saw a continued increase in the emergence of campaigns involving variants incorporating several exploits within the same sample, allowing for the harvesting of several different kinds of IoT devices into the same botnet.
Since then we have also observed Mirai malware authors experimenting with new exploits, found on the publicly available exploit-db, to gauge gains in bot count from the use of these exploits.
This latest new variant we’ve observed and detailed in this post appears to be a continuation of the same trend.
Exploits
This latest variant contains a total of 18 exploits, 8 of which are new to Mirai.
The vulnerabilities being exploited in the wild by this new Mirai variant for the first time are listed below with more details in Table 1 in the Appendix:
CVE-2019-3929
OpenDreamBox Remote Code Execution
CVE-2018-6961
CVE-2018-7841
CVE-2018-11510
Dell KACE Remote Code Execution
CVE-2017-5174
HooToo TripMate Remote Code Execution
The new samples also include four exploits which have only been used by Mirai in the past:
LG Supersign TVs
WePresent WiPG-1000 Wireless Presentation Systems
Belkin WeMo devices
MiCasaVerde VeraLite Smart Home Controllers
These new samples also include exploits targeting the Oracle WebLogic Servers RCE vulnerability which has been used by both Linux and Windows botnets.
All of the exploits that have already been seen exploited by Mirai in the past have been listed in Table 3 in the Appendix.
Analysis
The new variant we have discovered also has other distinguishing features from the use of the exploits mentioned above.
The encryption key used for the string table is 0xDFDAACFD, which is the equivalent of a byte wise XOR with 0x54, based on the standard encryption scheme (as implemented in the toggle_obf function) used in the original Mirai source code.
There are several default credentials used for brute force we have not come across previously in our research (though we cannot confirm this is their first use with Mirai).
These are listed in Table 2 in the Appendix along with the devices that make use of them – of note, all of these credentials can be found online.
Infrastructure
The samples were available at an open directory pictured in Figure 1:
Figure 1.
Open directory hosting Mirai variant
Samples of this variant use two domains for C2, at different ports in the different versions, as explained below.
The latest version makes use of the two domains below for C2.
akuma.pw :17
akumaiotsolutions.pw:912
While the two domains don’t currently resolve to any IP, a search on Shodan for the IP address hosting the samples, indicates port 17 at that address was used for C2 at some point of time.
This is seen in the response recorded from port 17 in the screenshot which is the expected response from a Mirai C2 server based on how the C2 code is written in the original source code.
Figure 2.
Shodan search result indicating 31.13.195.251:17 was used for C2 at one point
The directory hosting the malware was updated a couple of times, before the final version was uploaded at 26-May-2019 10:05 (server time).
Each of the updates were minor where the attackers either edited C2 port numbers or slightly updated the payload.
File upload times:
26-May-2019 10:05
21-May-2019 16:34
21-May-2019 08:38
19-May-2019 06:05
The briefly available version from May 21, 2019 at 08:38 made use of the below two domains for C2.
They are the same domains as used by the other samples (uploaded on prior or later dates) but the ports are different.
akuma.pw:1822
akumaiotsolutions.pw:721
Conclusion
This newly discovered variant is a continuation of efforts by Linux malware authors to scout for a wider range and thus, larger number, of IoT devices to form larger botnets thereby affording them greater firepower for DDoS attacks.
Based on the results observed by using such variants, the exploits that are more effective i.e.
the ones that infect a greater number of devices are retained or reused in future variants whereas the less effective ones are retired or replaced by malware authors with other exploits.
Palo Alto Networks customers are protected by:
WildFire which detects all related samples with malicious verdicts
Threat Prevention and PANDB that block all exploits and IPs/URLs used by this variant.
AutoFocus customers can track these activities using individual exploit tags:
CVE-2019-3929
OpenDreamBox_RCE
CVE-2018-6961
CVE-2018-7841
CVE-2018-11510
DellKACE_SysMgmtApp_RCE
CVE-2017-5174
HooTooTripMate_RCE
BelkinWeMoRCE
MiCasaVeraLiteRCE
CVE-2018-17173
WePresentCmdInjection
ASUS_DSLModem_RCE
CVE-2019-2725
NetgearReadyNAS_RCE
CVE-2014-8361
The malware family can be tracked in AutoFocus using the tag Mirai.
Appendix
