Starting in April 2017, we saw a significant decrease in Rig exploit kit (EK) activity after two major campaigns, EITest and pseudo-Darkleech, stopped using EKs.
Figure 1 shows the hits for the Rig EK from December 2016 through May 2017, highlighting this trend.
This blog reviews recent developments in the EITest and pseudo-Darkleech campaigns that have contributed to the current drop in Rig EK.
We also explore other causes for the overall decline of EK activity as others have noted in recent reports.
Finally, due to the anemic nature of today’s EK scene, we review some methods criminals are focusing on for malware distribution.
Figure 1: Hits for Rig EK from December 2016 through May 2017.
At the very end of March 2017, researchers stopped seeing indicators of the pseudo-Darkleech campaign.
Pseudo-Darkleech was a long-running campaign that switched to Rig EK in September 2016.
Since September 2016, pseudo-Darkleech accounted for a significant amount of Rig EK seen on a daily basis.
When pseudo-Darkleech disappeared, Rig EK activity dropped approximately 50 percent from previous months.
Three to four weeks later, another long-running campaign cut back on its use of Rig EK.
Near the end of April 2017, the EITest campaign began pushing tech support scams.
Previously, EITest had also generated a great deal of Rig EK traffic, but as the criminals behind this activity began focusing on other techniques, Rig EK levels dropped another 50 percent in May 2017.
As we enter June, EITest is primarily pushing tech support scams, and it does not appear to be utilizing EKs at this time.
Figure 2 shows the hits for Rig EK from March 1, 2017 through May 31, 2017 in more detail.
Note on the chart when pseudo-Darkleech disappears and EITest shifts focus and their impact on Rig EK traffic.
Although researchers still find Rig from other campaigns like RoughTed or Seamless, recent levels are their lowest since we began tracking this EK.
Figure 2: Rig EK hits from March 1st through May 31st, 2017.
Rig is not the only EK suffering in today’s threat landscape.
All EKs have been affected.
So why aren’t EKs as active as they once were?
One contributing factor is that the target surface for EKs is getting smaller.
EKs typically use browser-based exploits targeting Microsoft Windows systems.
They are primarily focused on Internet Explorer, Microsoft Edge, and Adobe Flash Player.
EKs are largely ineffective against more popular browsers like Chrome, a product that has gone through four major version updates this year alone.
Users (potential victims) are moving to other browsers, and this has greatly reduced the number of possible targets for current EKs.
As shown below in Figure 3, as of May 2017, only 19 percent of the desktop browser market was taken by Microsoft Edge and Internet Explorer 11 combined.
Figure 3: Desktop browser market share in May 2017 from NetMarketShare.com.
With a declining target base, EKs are not aging gracefully.
In previous years, we saw a variety of EKs used by various campaigns.
But by the end of 2015, notable EKs like Sweet Orange and Fiesta had disappeared.
As 2016 progressed, other prominent EKs like Nuclear and Angler also shut down.
The graveyard of expired EKs has several dozen names by now.
This lack of diversity has impacted EK development.
According to Proofpoint, more than a year has passed since any major EK has featured a zero-day exploit, making EKs far less effective compared to previous years.
Furthermore, the security community has been much more active against EKs.
Recent efforts by Cisco Talos in 2016 and RSA Research in 2017 have seen researchers coordinating with hosting providers to take down servers used in domain shadowing schemes favored by EKs.
The resulting setbacks have not been permanent, but they have significantly impacted operations for criminals using EKs.
Ultimately, a declining browser target base, lack of new exploits, and recent efforts by the community to fight domain shadowing have all contributed to an overall decline in EK activity.
As EKs become more ineffective, criminals are focusing on other methods like malicious spam attacks, or social engineering schemes like HoeflerText notifications like shown in Figure 4.
Whether through spam or a browser popup, criminals trick potential victims into double-clicking a file that infects their computers.
Figure 4: A fake HoeflerText notification in Google Chrome that leads to malware.
In some cases, URLs will redirect to an EK one day and then on following days will often redirect to a fake installer for something like Adobe Flash Player like shown in Figure 5.
These social engineering schemes are becoming more common, and researchers often run across them as they search for EKs.
Figure 5: Fake Flash installer distributing the same malware Rig EK did the day prior.
In some cases, criminals have turned away from malware entirely, and are focusing on apparently more lucrative activity.
For example, the EITest campaign has switched to pushing tech support scams.
At first, this seemed to be location-based, targeting the US and UK.
However, as we go into June 2017, this type of activity is all we have found from the EITest campaign in recent days.
Figure 6 below shows a page viewed on June 7th, 2017 from a website compromised by the EITest campaign.
The highlighted portion is a URL that redirects to a tech support scam website shown in Figure 7 that states your computer has been infected.
Figure 6: Injected script in page from a site compromised by the EITest campaign.
Figure 7: The tech support scam site.
This particular campaign also has audio continually reinforcing the same information.
You cannot simply click okay or close the browser.
The windows will immediately reappear.
In order to close the browser and stop the audio, you must use the task manager to kill the browser process.
These tech support scams have been so successful that they are now a constant feature of our threat landscape.
The EITest campaign has been pushing them for more than a month now.
Conclusion
Although EK activity levels are down, we still see indicators of Rig and Magnitude on a near-daily basis.
But EKs are a relatively minor factor in today’s threat landscape compared to social engineering schemes and malspam.
Users who follow best security practices are much less likely to be affected by the EK threat.
However, this situation could change as new exploits appear and updated techniques are used in malware distribution.
It always pays to be prepared.
Threat detection, preventions, and protection solutions like Palo Alto Networks next-generation security platform are a key part of any prevention strategy.
