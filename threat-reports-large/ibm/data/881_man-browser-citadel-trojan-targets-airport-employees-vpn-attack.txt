IBM recently discovered a sophisticated man-in-the-browser (MitB) enterprise attack that targets virtual private network (VPN) users at a major international airport hub.
Using the Citadel Trojan, criminals are targeting employees to steal their credentials for accessing internal airport applications.
IBM has notified airport officials and the relevant government agencies of this attack.
Due to the sensitive nature of these systems, the airport immediately disabled remote employee access through this VPN site; the site is currently down.
VPNs are often used to secure Internet connections between a business’s private network and a remote employee.
VPNs provide users with secure remote access to applications and data that reside inside an enterprise’s firewall.
However, once an attacker steals a victim’s VPN credentials, they can log in as the authorized user and have unfettered access to the information and resources associated with the account.
These types of complex attacks use a combination of form-grabbing and screen-capture technologies to steal the victim’s username, password and the one-time passcode generated by a strong authentication product.
The first part of the attack uses form-grabbing to steal the username and password entered into the login screen.
The second part of the attack relies on screen-capture capabilities to take a snapshot of the image presented to the victim by the strong authentication product.
The strong authentication product offers two authentication options: single channel and dual channel.
The dual-channel mode sends users a one-time PIN via SMS or a mobile application.
The single-channel mode is activated when the user selects the “Get Image” option at login.
This prompts the strong authentication product to generate an on-screen CAPTCHA of 10 digits.
The user then maps his or her original (static) password to the string of digits in the image to produce the one-time code.
This security measure prevents the form-grabber from capturing the actual static password.
This is where the screen-capturing feature in Citadel kicks in.
By capturing the image, the attacker uses the permutation of digits, along with the one-time code stolen by the form-grabber, to reproduce the static password.
This is a clever use of form-grabbing and screen-grabbing techniques by attackers.
It also demonstrates how enterprises that rely on strong authentication approaches are still at risk from targeted attacks if they lack cyber crime prevention security on endpoint devices.
This is especially true in the case of unmanaged or bring-your-own-device (BYOD) endpoints.
Because these mobile devices are exposed to threats that would otherwise be filtered at the enterprise perimeter, they are much more vulnerable to infection from advanced malware like Citadel, Zeus or SpyEye.
When an unmanaged, infected device connects to the enterprise via a VPN or some other remote access method, malware can circumvent strong authentication systems, as evidenced by the attack above.
The Citadel malware used in this attack is typically used to execute online banking and other forms of financial fraud.
However, this is not the first time IBM has identified and reported on enterprises being targeted by screen-capturing/form-grabbing financial malware.
This form of man-in-the-browser attack is especially troubling given the potential impact on air travel security and border control.
