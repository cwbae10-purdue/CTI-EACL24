In our last post, we warned of a new Windows local privilege escalation vulnerability being used in the wild.
We noted that the Windows bug (CVE-2013-5065) was exploited in conjunction with a patched Adobe Reader bug (CVE-2013-3346) to evade the Reader sandbox.
CVE-2013-3346 was exploited to execute the attackerâ€™s code in the sandbox-restricted Reader process, where CVE-2013-5065 was exploited to execute more malicious code in the Windows kernel.
In this post, we aim to describe the in-the-wild malware sample, from initial setup to unrestricted code execution.
CVE-2013-3346: Adobe Reader ToolButton Use-After-Free
CVE-2013-3346 was privately reported to ZDI by Soroush Dalili, apparently in late 2012.
We could fine no public description of the vulnerability.
Our conclusion that the sample from the wild is exploiting CVE-2013-3346 is based upon the following premises:
The sample contains JavaScript that triggers a use-after-free condition with ToolButton objects.
CVE-2013-3346 is a use-after-free condition with ToolButton objects.
The Adobe Reader patch that addresses CVE-2013-3346 also stops the in-the-wild exploit.
