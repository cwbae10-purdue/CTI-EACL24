One good thing about having a lot of Facebook friends is that you simply act as a honey pot when your friends click on malicious things.
A few days ago I got a message on Facebook from a person I very rarely speak to, and I knew that something fishy was going on.
After just a few minutes analyzing the message, I understood that I was just peeking at the top of this iceberg.
This malware was spreading via Facebook Messenger, serving multi platform malware/adware, using tons of domains to prevent tracking, and earning clicks.
The code is advanced and obfuscated.
Here is a screenshot of the JavaScript, an potential injector.
Filename is “injection.js” (ebc117c0cf03ad4b13184d1253862586)
The initial spreading mechanism seems to be Facebook Messenger, but how it actually spreads via Messenger is still unknown.
It may be from stolen credentials, hijacked browsers or clickjacking.
At the moment we are not sure because this research is still ongoing.
The message uses traditional social engineering to trick the user into clicking the link.
The message reads “David Video” and then a bit.ly link.
The link points to a Google doc.
The document has already taken a picture from the victim’s Facebook page and created a dynamic landing page which looks like a playable movie.
When the victim clicks on the fake playable movie, the malware redirects them to a set of websites which enumerate their browser, operating system and other vital information.
Depending on their operating system they are directed to other websites.
This technique is not new and has a lot of names.
I would like to describe it as a domain chain, basically just A LOT of websites on different domains redirecting the user depending on some characteristics.
It might be your language, geo location, browser information, operating system, installed plugins and cookies.
By doing this, it basically moves your browser through a set of websites and, using tracking cookies, monitors your activity, displays certain ads for you and even, in some cases, social engineers you to click on links.
We all know that clicking on unknown links is not something that’s recommended, but through this technique they can basically force you to do so.
What I noticed during my research was that when changing the User-Agent header (browser information) the malware redirects you to different landing pages.
For example, when using FIREFOX I was redirected to a website displaying a fake Flash Update notice, and then offered a Windows executable.
The executable is flagged as adware.
When using the Google Chrome browser I was redirected to a website which mimics the layout of YouTube, even including the YouTube logo.
The website then displays a fake error message tricking the user to download a malicious Google Chrome extension from the Google Web Store.
The Chrome Extension is a Downloader, which means that it downloads a file to your computer.
At the time of writing, the file which should have been downloaded was not available.
One interesting finding is that the Chrome Extension has log files from the developers displaying usernames.
It is unclear if this is related to the campaign, but it is still an amusing piece of information.
When using the OSX Safari browser I ended up on a similar website to the one I was directed to when using Firefox, but it was customized for OSX users.
It was a fake update for Flash Media Player, and when I clicked the link an OSX executable .dmg file was downloaded.
This file was also adware.
It has been a while since I saw these adware campaigns using Facebook, and its pretty unique that it also uses Google Docs, with customized landing pages.
As far as I can see no actual malware (Trojans, exploits) are being downloaded but the people behind this are most likely making a lot of money in ads and getting access to a lot of Facebook accounts.
Please make sure that you don’t click on these links, and please update your antivirus!
