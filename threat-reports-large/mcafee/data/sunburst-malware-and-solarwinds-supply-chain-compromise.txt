Part I of II
In a blog post released 13 Dec 2020, FireEye disclosed that threat actors compromised SolarWinds’s Orion IT monitoring and management software with a trojanized version of SoalrWinds.Orion.Core.BusinessLayer.dll.
The trojanized file delivers the SUNBURST malware through a backdoor as part of a digitally-signed Windows Installer Patch.
Use of a Compromised Software Supply Chain (T1195.002) as an Initial Access technique is particularly critical as it can go undetected for a long period.
FireEye released countermeasures that can identify the SUNBURST malware.
If you are using SolarWinds software, please refer to the company’s guidance here to check for vulnerable versions and patch information.
McAfee has evaluated the published countermeasures and will continue to analyze further attack indicators.
It’s important to note that this was a very sophisticated attack and customers are advised to assess their overall security architecture capability to either prevent, detect or respond to an APT threat.
This attack reminds us that in today’s digital enterprise the supply chain includes many diverse elements including but not limited to critical equipment and hardware, cloud software and infrastructure as a service provider and critical IT software.
Customers are advised to assess both intellectual property protection and supply chain integrity strategies.
Part one of this blog series details initial McAfee defensive guidance and response actions.
Part two will describe additional mitigation and solution recommendations.
For the latest information on McAfee see KB93861and subscribe to receive updates.
Below is protection summary to date for the known backdoor indicators
GTI Cloud and latest DAT has coverage for known indicators and C2 domains for the backdoor
McAfee Web Gateway can block known C2 domains
McAfee is continuing to review other detection approaches, including Real Protect and Endpoint Detection and Response
McAfee Advanced Threat Researchers continue to hunt for new indicators.
Intelligence updates will be made available in MVISION Insights
Signatures are available for Network Security Platform to detect network indicators of compromise
McAfee Labs will continue analysis for any known indicators associated with this attack and update product protection accordingly.
Furthermore, analysis is underway to analyse the behavioural components of the campaign and ensure product efficacy considers protection beyond static measures such as signatures.
MVISION Insights is tracking the campaign as SolarWinds Supply Chain Attack Affecting Multiple Global Victims with SUNBURST Backdoor.
Customers can view the public version of MVISION Insights for the latest attack details, prevalence, techniques used and indicators of compromise.
Insights provides the indicators used by SUNBURST.
The indicators will continue to update based on automated collection and human analysis.
You can use the indicators to hunt on your network.
Note: This will be updated as new indicators are verified.
Insights outlines the MITRE Att&ck techniques used by SUNBURST.
You can use MITRE Att&ck framework to asses defensive capability across your security architecture.
One of the first initial response actions should be to hunt for known indicators of the attack.
You can use MVISION EDR or MAR to search endpoints for SUNBURST backdoor indicators as provided by Microsoft and FireEye.
See the search syntax below.
If you are licensed for MVISION Insights this query will take place automatically.
Additional defensive guidance will be published in an upcoming blog.
Begin MVEDR Query Syntax…
Files name, full_name, md5, sha256, created_at, create_user_name, create_user_domain and HostInfo hostname, ip_address, os and LoggedInUsers username, userdomain where Files sha256 equals “ac1b2b89e60707a20e9eb1ca480bc3410ead40643b386d624c5d21b47c02917c” or Files sha256 equals “c09040d35630d75dfef0f804f320f8b3d16a481071076918e9b236a321c1ea77” or Files sha256 equals “eb6fab5a2964c5817fb239a7a5079cabca0a00464fb3e07155f28b0a57a2c0ed” or Files sha256 equals “dab758bf98d9b36fa057a66cd0284737abf89857b73ca89280267ee7caf62f3b” or Files sha256 equals “32519685c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77” or Files sha256 equals “d0d626deb3f9484e649294a8dfa814c5568f846d5aa02d4cdad5d041a29d5600” or Files sha256 equals “53f8dfc65169ccda021b72a62e0c22a4db7c4077f002fa742717d41b3c40f2c7” or Files sha256 equals “019085a76ba7126fff22770d71bd901c325fc68ac55aa743327984e89f4b0134” or Files sha256 equals “ce77d116a074dab7a22a0fd4f2c1ab475f16eec42e1ded3c0b0aa8211fe858d6” or Files sha256 equals “32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77” or Files sha256 equals “292327e5c94afa352cc5a02ca273df543f2020d0e76368ff96c84f4e90778712” or Files sha256 equals “c15abaf51e78ca56c0376522d699c978217bf041a3bd3c71d09193efa5717c71”
…End MVEDR Query Syntax
You should also search McAfee Web Gateway logs (or other network and SIEM logs) for communication to command and control domains or IP addresses, particularly those categorized as “Malicious Sites” below.
Continue to check MVISION Insights for new domains and URLs.
It’s important to note that ongoing analysis will be critical to understand how the attackers will adapt and what additional mitigation is required.
This will be a continuous process and we expect to add multiple updates to KB93861.
Additionally, customers should follow McAfee Labs posts, check Insights Public Dashboard for latest threat intelligence, and continually check the Knowledge Center for latest product guidance.
Part two of this blog will cover defensive capabilities and controls in more depth.
Every week Insights Preview highlights the top emerging threats and campaigns based on ATR Operational Intelligence collection and analysis.
Follow the latest COVID Threat statistics on the public Atlas Dashboard.
For more information about how a customer can utilize Atlas and Intelligence as a Service from APG, speak to your McAfee Account Manager for a Threat Intel Briefing and Workshop.
McAfee Labs and Advanced Threat Research teams produce regular research reports with the latest threat intelligence statistics and trends.
Please share the reports with customers.
Review and Share our external blogs that feature deeper malware analysis and explanations on emerging threats and attack campaigns.
