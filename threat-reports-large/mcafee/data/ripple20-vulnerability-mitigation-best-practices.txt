On June 16th, the Department of Homeland Security and CISA ICS-CERT issued a critical security advisory warning covering multiple newly discovered vulnerabilities affecting Internet-connected devices manufactured by multiple vendors.
This set of 19 vulnerabilities in a low-level TCP/IP software library developed by Treck has been dubbed “Ripple20” by researchers from JSOF.
A networking stack is a software component that provides network connectivity over the standard internet protocols.
In this specific case these protocols include ARP, IP (versions 4 and 6), ICMPv4, UDP and TCP communications protocols, as well as the DNS and DHCP application protocols.
The Treck networking stack is used across a broad range of industries (medical, government, academia, utilities, etc.
), from a broad range of device manufacturers – a fact which enhances their impact and scope, as each manufacturer needs to push an update for their devices independently of all others.
In other words, the impact ripples out across the industry due to complexities in the supply and design chains.
Identifying vulnerable devices on your network is a crucial step in assessing the risk of Ripple20 to your organization.
While a simple Shodan search for “treck” shows approximately 1000 devices, which are highly likely to be internet-facing vulnerable devices, this represents only a fraction of the impacted devices.
Identification of the Treck networking stack vs. other networking stacks (such as the native Linux or Windows stacks) requires detailed analysis and fingerprinting techniques based on the results of network scans of the devices in question.
The impact of these vulnerabilities ranges from denial of service to full remote code exploitation over the internet, with at least one case not requiring any authentication (CVE-2020-11901).
JSOF researchers identified that these vulnerabilities impact a combination of traditional and IoT devices.
Customers should review advisories from vendors such as Intel and HP because non-IoT devices may be running firmware that makes use of the Treck networking stack.
Ripple20’s most significant impact is to devices whose network stack is exposed (in general IoT devices incorporating the Treck network stack) as compared to devices that incorporate the stack that it is only exposed to the local device.
We recommend that you audit all network-enabled devices to determine if they are susceptible to these vulnerabilities.
There are potentially tens of millions of devices that are vulnerable to at least one of the Ripple20 flaws.
Mitigating impact requires attention from both device owners and device vendors.
Patch any device for which a vendor has released an update.
Practice the principle of least privilege for all users and devices (devices and users should only have access to the set of capabilities needed to accomplish their job).
In this case, minimize network exposure and internet-accessibility for all control system devices.
Locate control system networks and remote devices behind firewalls and isolate them from the business network.
When remote access is required, use secure methods, such as Virtual Private Networks (VPNs), recognizing that VPNs may have vulnerabilities and should be updated to the most current version available.
Also recognize that a VPN is only as secure as the connected devices.
VPN solutions should use multi-factor authentication.
Use caching DNS servers in your organization, prohibiting direct DNS queries to the internet.
Ideally, caching DNS servers should utilize DNS-over-HTTPS for lookups.
Block anomalous IP traffic by utilizing a combination of firewalls and intrusion prevention systems.
Please review KB93020 for more information and subscribe for updates.
