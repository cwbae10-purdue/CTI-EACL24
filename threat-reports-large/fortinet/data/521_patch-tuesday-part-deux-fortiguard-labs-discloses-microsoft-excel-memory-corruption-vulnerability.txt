Overview
Microsoft Patch Tuesday continues with another FortiGuard vulnerability disclosure, this time affecting Microsoft Excel.
For a bit of background on Microsoft Office in general and Office 2007 in particular, check out today's first disclosure.
In this case, a memory corruption vulnerability has been discovered in Microsoft Excel 2007.
The vulnerability exists due to an error while the vulnerable software attempts to open a specially crafted Excel file.
As with the other disclosures today, this vulnerability could lead to remote code execution.
Analysis
Based on our analysis, this is a memory corruption vulnerability.A comparison between a normal Excel file and a specially crafted PoC file is shown below.
Figure 1.
The Normal Excel File vs The PoC File
From the above analysis, the address 0x00730834 points to an invalid heap memory address.
As a result, it causes the crash when attempting to free it.
Because we can control the memory address to be freed, we can free memory at any address and read data at any memory address, potentially leading to arbitrary code execution.
Because we can control the memory address to be freed, we can free memory at any address and read data at any memory address.
Attackers can leverage this behavior to control the flow of execution.
Mitigation
All users of Microsoft Office 2007 are encouraged to upgrade to the latest version of this software.
Additionally, organizations that have deployed Fortinet IPS solutions are already protected from this vulnerability with the signature MS.Excel.Execution.Path.Parsing.Code.Execution.
Additional information can be found at http://technet.microsoft.com/security/bulletin/MS15-131 and https://www.mitre.org/.
