
        Sample queries for Advanced hunting in Microsoft 365 Defender
This repo contains sample queries for advanced hunting in Microsoft 365 Defender.
With these sample queries, you can start to experience advanced hunting, including the types of data that it covers and the query language it supports.
You can also explore a variety of attack techniques and how they may be surfaced through advanced hunting.
Advanced hunting queries provide a great starting point for locating and investigating suspicious behavior, and they can be customized to fit your organization's unique environment.
Further, you can use these queries to build custom detection rules if you determine that behaviors, events, or data from the advanced hunting query helps you surface potential threats.
NOTE: Most of these queries can also be used in Microsoft Defender ATP.
However, queries that search tables containing consolidated alert data as well as data about email, apps, and identities can only be used in Microsoft 365 Defender.
To get started, simply paste a sample query into the query builder and run the query.
If you get syntax errors, try removing empty lines introduced when pasting.
If a query returns no results, try expanding the time range.
We are continually building up documentation about advanced hunting and its data schema.
You can access the full list of tables and columns in the portal or reference the following resources:
This project welcomes contributions and suggestions.
Most contributions require you to agree to a
Contributor License Agreement (CLA) declaring that you have the right to, and actually do, grant us
the rights to use your contribution.
When you submit a pull request, a CLA bot will automatically determine whether you need to provide
a CLA and decorate the PR appropriately (e.g., status check, comment).
Simply follow the instructions
provided by the bot.
You will only need to do this once across all repos using our CLA.
This project has adopted the Microsoft Open Source Code of Conduct.
For more information see the Code of Conduct FAQ or
contact opencode@microsoft.com with any additional questions or comments.
Everyone can freely add a file for a new query or improve on existing queries.
To help other users locate new queries quickly, we suggest that you:
In addition, construct queries that adhere to the published advanced hunting performance best practices.
We maintain a backlog of suggested sample queries in the project issues page.
Feel free to comment, rate, or provide suggestions.
Let us know if you run into any problems or share your suggestions by sending email to wdatpqueriesfeedback@microsoft.com.

      Sample queries for Advanced hunting in Microsoft 365 Defender
