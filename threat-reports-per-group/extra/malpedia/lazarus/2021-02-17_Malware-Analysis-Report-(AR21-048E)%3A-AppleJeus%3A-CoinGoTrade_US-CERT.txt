An official website of the United States government Here's how you know
This report is provided "as is" for informational purposes only.
The Department of Homeland Security (DHS) does not provide any warranties of any kind regarding any information contained herein.
The DHS does not endorse any commercial product or service referenced in this bulletin or otherwise.
This document is marked TLP:WHITE--Disclosure is not limited.
Sources may use TLP:WHITE when information carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release.
Subject to standard copyright rules, TLP:WHITE information may be distributed without restriction.
For more information on the Traffic Light Protocol (TLP), see http://www.us-cert.gov/tlp.
This MAR highlights this cyber threat posed by North Korea and provides detailed indicators of compromise (IOCs) used by the North Korean government.
The U.S. Government refers to malicious cyber activity by the North Korean government as HIDDEN COBRA.
For more information on other versions of AppleJeus and recommended steps to mitigate this threat, see Joint Cybersecurity Advisory AA21-048A: AppleJeus: Analysis of North Korea's Cryptocurrency Malware at https://www.us-cert.cisa.gov/ncas/alerts/AA21-048A.
There have been multiple versions of AppleJeus malware discovered since its initial discovery in August 2018.
In most versions, the malware appears to be from a legitimate-looking cryptocurrency trading company and website, whereby an unsuspecting individual downloads a third-party application from a website that appears legitimate.
The U.S. Government has identified AppleJeus malware version—CoinGoTrade—and associated IOCs used by the North Korean government in AppleJeus operations.
CoinGoTrade discovered in October 2020, is a legitimate-looking cryptocurrency trading software that is marketed and distributed by a company and website—CoinGoTrade and coingotrade[.
Some information has been redacted from this report to preserve victim anonymity.
For a downloadable copy of IOCs, see: MAR-10322463-5.v1.stix.
This Windows program from the CoinGoTrade site is a Windows MSI Installer.
The installer appears to be legitimate and will install "CoinGoTrade.exe" (3e5442440aea07229a1bf6ca2fdf78c5e2e5eaac312a325ccb49d45da14f97f4) in the “C:\Program Files (x86)\CoinGoTrade” folder.
It will also install "CoinGoTradeUpdate.exe" (572a124f5665be68eaa472590f3ba75bf34b0ea2942b5fcbfd3e74654202dd09) in the “C:\Users\<username>\AppData\Roaming\CoinGoTradeSupport” folder.
Immediately after installation, the installer launches "CoinGoTradeUpdate.exe."
During installation, a "CoinGoTrade" folder containing the "CoinGoTrade.exe" application is added to the start menu.
Figure 1 - Screenshot of "CoinGoTrade" installation.
Whois for coingotrade.com had the following information:
			Registrar: NAMECHEAP INC
			Creation Date: 2020-02-28
			Registrar Registration Expiration Date: 2021-02-28
The domain "coingotrade.com" had a legitimately signed Sectigo Secure Sockets Layer (SSL) certificate, which was “Domain Control Validated," similar to the domain certificates for previous AppleJeus variants.
Investigation revealed the point of contact listed for verification was support[@]coingotrade.com.
No other contact information was available as the administrative or technical contact for the coingotrade.com domain.
The domain is registered with NameCheap at the IP address 198.54.114.175 with ASN 22612.
Investigation revealed the IP address 198.54.114.175 was hosted at NameCheap, but no records were available at the time of writing.
Figure 2 -  Screenshot of the "CoinGoTrade" website.
This file is a 32-bit Windows executable contained within the Windows MSI Installer "CoinGoTrade.msi."
When executed, "CoinGoTrade.exe" loads a legitimate looking cryptocurrency wallet application with no signs of malicious activity.
The strings for "CoinGoTrade.exe" contain the command and control (C2) "hxxp[:]//23.152.0.101:8080/ which was also identified in the MacOS CoinGo_Trade (527792dfab79f026eaa6930d2109c93e816ed31826dba0338a9223db71aced18) and the Kupay Wallet Stage 2 from AppleJeus version 4.
In addition, a build path is present in the strings “U:\work\CryptoMex\teobot\teobot\obj\Release\CoinGoTrade.pdb" and the file properties description also states “CryptoMex."
CryptoMex is likely an open source cryptocurrency application which was copied in order to create this application.
Figure 3 - Screenshot of "CryptoMex" listed in CoinGoTrade.exe" properties.
This IP address is the C2 for "CoinGoTrade.exe" and "CoinGo_Trade."
This file is a 32-bit Windows executable contained within the Windows MSI Installer "CoinGoTrade.msi."
When executed, CoinGoTradeUpdate.exe will installs itself as a service, which will automatically start when any user logs on.
The service is installed with the description of “Automatic CoinGoTrade Upgrade."
After installing the service, "CoinGoTradeUpdate.exe" has similar behavior to the updater component for AppleJeus version 4 "Kupay Wallet."
On startup "CoinGoUpdate.exe" allocates memory to write a file.
After allocating the memory and storing the hard-coded string “Latest” in a variable, the program attempts to open a network connection.
The connection is named "CoinGoTrade 1.0 (Check Update Windows)," which is likely to avoid suspicion from a user.
Similarly, to previous AppleJeus variants, "CoinGoTradeUpdate.exe" collects some basic information from the system as well as a timestamp, and places the collected information in hard-coded format strings.
Specifically, the timestamp is placed into a format string “ver=%d&timestamp=%lu” where "ver" is set as the 1000, possibly referring to the CoinGoTrade version previously mentioned.
This basic information and hard-coded strings are sent via a POST to the C2 "coingotrade.com/update_coingotrade.php."
If the POST is successful (i.e.
returns an HTTP response status code of 200) but fails any of multiple different checks, "CoinGoTradeUpdate.exe" will sleep for two minutes and then regenerate the timestamp and contact the C2 again.
After receiving the payload from the C2, the program writes the payload to memory and executes the payload.
The payload for the Windows malware could not be downloaded, as the C2 server "coingotrade.com/coingotrade_update.php" was no longer accessible.
In addition, the sample was not identified in open source reporting for this sample.
The Windows payload is likely similar in functionality to "prtspool" (5e40d106977017b1ed235419b1e59ff090e1f43ac57da1bb5d80d66ae53b1df8) the OSX stage 2 sample.
Figure 4 - Screenshot of the format string and version.
This OSX program from the CoinGoTrade site is an Apple DMG installer.
The installer was hosted at hxxps[:]//coingotrade.com/[GUID].
The [GUID] is a unique file that is crafted for a specific victim and is being withheld to preserve the identity of the intended recipient.
The OSX program is an Apple DMG installer with the file name CoinGoTrade.dmg.
The OSX program does not have a digital signature and will warn the user of that before installation.
The installer contains a postinstall script (Figure 5).
The postinstall script is identical in functionality to the postinstall scripts from previous AppleJeus variants and is identical to the AppleJeus variant 4 "Kupay" postinstall script without the "launchctl" command.
The postinstall script creates a “CoinGoTradeService” folder in the OSX “/Library/Application Support” folder and moves "CoinGoTradeUpgradeDaemon" to it.
The “Application Support” folder contains both system and third-party support files which are necessary for program operation.
Typically, the subfolders have names matching those of the actual applications.
At installation, CoinGoTrade placed the plist file (com.coingotrade.pkg.product.plist) in “/Library/LaunchDaemons/."
As the LaunchDaemon will not be run immediately after the plist file is moved, the postinstall script then launches the "CoinGoTradeUpgradeDaemon" program in the background.
Figure 5 - Screenshot of the postinstall script.
Figure 6 - Screenshot of "com.coingotrade.pkg.product.plist."
This OSX sample was contained within Apple DMG installer "CoinGoTrade.dmg."
"CoinGo _Trade" is likely a copy of an open source cryptocurrency application.
The strings for "CoinGo_Trade" contain the C2 hxxp[:]//23.152.0.101:8080, which is also found in the Windows CoinGoTrade.exe (3e5442440aea07229a1bf6ca2fdf78c5e2e5eaac312a325ccb49d45da14f97f4) and the Kupay Wallet Stage 2 from AppleJeus version 4.
This OSX sample was contained within Apple DMG installer "CoinGoTrade.dmg."
"CoinGoTradeUpgradeDaemon" is similar to "kupay_upgrade" from AppleJeus version 4.
When executed, "CoinGoTradeUpgradeDaemon" will immediately sleep for five seconds and then test to see if the hard-coded value stored in “isReady” is a 0 or a 1.
If it is a 0, the program sleeps again and if it is a 1, the function “CheckUpdate” is called.
This function contains most of the logic functionality of the malware.
"CheckUpdate" sends a POST to the C2 hxxps[:]//coingotrade.com/update_coingotrade.php with a connection named “CoinGoTrade 1.0 (Check Update Osx).
If the C2 server returns a file, it is decoded and written to “/private/tmp/updatecoingotrade” and the permissions are set with the command "chmod" 700 (only the user can read, write, and execute).
The stage 2 malware (/private/tmp/updatecoingotrade) is then launched and the malware "CoinGoTradeUpgradeDaemon" returns to sleeping and checking in with the C2 server.
The stage 2 payload for CoinGoTrade was no longer available from the specified download URL, however, there was a file "prtspool" (5e40d106977017b1ed235419b1e59ff090e1f43ac57da1bb5d80d66ae53b1df8) submitted to VirusTotal by the same user on the same date as "CoinGoTradeUpgradeDaemon."
This suggests the submitted file may be related to the OSX malware and could be the downloaded payload.
Analysis by Crowdstrike showed the file has the same encryption algorithm and initial key values as a Lazarus Group implant known as HOPLIGHT or MANUSCRYPT.
Figure 7 - Screenshot of the C2 loaded into variable.
Figure 8 - Screenshot of the format string.
This file is a OSX samples that was likely the payload for the sample "CoinGoTradeUpgradeDaemon.
Upload the current in memory configuration data.
Download a new configuration, overwrite the current in memory configuration and write the data to the file /private/etc/krb5d.conf
			Perform a secure delete or file wipe the specified file by overwriting it with all zeros before deleting it from the system.
Download a file from the C2 and write it to the specified path.
Upload a file from the specified file to the C2 server.
Execute the specified command on the OS shell, pipe the output to a temporary file, and upload it to the C2.
List the files and directories in the specified path.
Perform a TCP connection to the specified IP address and port and report the status back to the C2.
Set the current working directory to the specified path.
--End capabilities--
			The file has three C2 URLs hard-coded into the file.
In communicating with these servers, the file uses an HTTP POST with multipart-form data boundary string "--N9dLfqxHNUUw8qaUPqggVTpX."
Similar to other Lazarus malware, "prtspool" uses format strings to store data collected about the system and sends it to the C2s.
--Begin C2 URLs--
			hxxps[:]//airbseeker.com/rediret.php
			hxxps[:]//globalkeystroke.com/pockbackx.php
			hxxps[:]//www[.]woodmate.it/administrator/help/en-GB/bins/tags/taghelper.php.
Whois for airbseeker.com had the following information:
			Registrar: NAMECHEAP INC
			Created: 2020-03-03
			Expires: 2021-03-03
The domain "airbseeker.com" has a legitimately signed Sectigo SSL certificate, which was “Domain Control Validated."
The domain was at the IP address 68.65.122.160 with ASN 22612.
Whois for globalkeystroke.com had the following information:
			Registrar: NAMECHEAP INC
			Created: 2019-11-11
			Expires: 2020-11-11
The domain "globalkeystroke.com" has a legitimately signed Sectigo SSL certificate, which was “Domain Control Validated."
Investigation revealed the point of contact listed for verification was admin[@]globalkeystroke.com.
No other contact information was available as the administrative or technical contact for the globalkeystroke.com domain.
The domain is registered with NameCheap at the IP address 68.65.122.160 with ASN 22612.
The IP address of 185.228.83.129 belongs to Access2.it Group B.v. ISP of the Netherlands.
Whois information for the IP revealed the network name as belonging to CrownCloud of Australia.
On October 11, 2019, the IP address 185.228.83.129 was hosting the domain dev.jmttrading.org according to PassiveDNS.
JMT Trading was the second variant of the AppleJeus malware.
Whois for woodmate.it had the following information:
			Registrar: REGISTRYGATE GMBH
			Created: 2014-05-07
			Expires: 2020-05-07
The domain "woodmate.it" has a legitimately signed Let’s Encrypt certificate.
Let’s Encrypt is a nonprofit Certificate Authority which provides free and automated TLS/SSL certificates for anyone running their software.
They do not perform any identity validation.
The domain is registered with RegistryGate GMBH of Germany at the IP address 85.13.146.113 with ASN 34788.
The IP address 85.13.146.113 is hosted by Neue Medien Muennich Gmbh of Germany.
CISA recommends that users and administrators consider using the following best practices to strengthen the security posture of their organization's systems.
Any configuration changes should be reviewed by system owners and administrators prior to implementation to avoid unwanted impacts.
Additional information on malware incident prevention and handling can be found in National Institute of Standards and Technology (NIST) Special Publication 800-83, "Guide to Malware Incident Prevention & Handling for Desktops and Laptops".
CISA continuously strives to improve its products and services.
You can help by answering a very short series of questions about this product at the following URL: https://us-cert.cisa.gov/forms/feedback/
A Malware Initial Findings Report (MIFR) is intended to provide organizations with malware analysis in a timely manner.
In most instances this report will provide initial indicators for computer and network defense.
To request additional analysis, please contact CISA and provide information regarding the level of desired analysis.
A Malware Analysis Report (MAR) is intended to provide organizations with more detailed malware analysis acquired via manual reverse engineering.
To request additional analysis, please contact CISA and provide information regarding the level of desired analysis.
Can I edit this document?
This document is not to be edited in any way by recipients.
All comments or questions related to this document should be directed to the CISA at 1-888-282-0870 or CISA Service Desk.
Can I submit malware to CISA?
Malware samples can be submitted via three methods:
CISA encourages you to report any suspicious activity, including cybersecurity incidents, possible malicious code, software vulnerabilities, and phishing-related scams.
Reporting forms can be found on CISA's homepage at www.cisa.gov.
This product is provided subject to this Notification and this Privacy & Use policy.
We recently updated our anonymous product survey; we'd welcome your feedback.
Receive security alerts, tips, and other updates.
CISA is part of the Department of Homeland Security
