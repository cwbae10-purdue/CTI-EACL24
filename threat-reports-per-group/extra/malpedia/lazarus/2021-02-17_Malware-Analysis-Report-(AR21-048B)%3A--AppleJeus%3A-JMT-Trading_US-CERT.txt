An official website of the United States government Here's how you know
This report is provided "as is" for informational purposes only.
The Department of Homeland Security (DHS) does not provide any warranties of any kind regarding any information contained herein.
The DHS does not endorse any commercial product or service referenced in this bulletin or otherwise.
This document is marked TLP:WHITE--Disclosure is not limited.
Sources may use TLP:WHITE when information carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release.
Subject to standard copyright rules, TLP:WHITE information may be distributed without restriction.
For more information on the Traffic Light Protocol (TLP), see http://www.us-cert.gov/tlp.
This MAR highlights this cyber threat posed by North Korea and provides detailed indicators of compromise (IOCs) used by the North Korean government.
The U.S. Government refers to malicious cyber activity by the North Korean government as HIDDEN COBRA.
For more information on other versions of AppleJeus and recommended steps to mitigate this threat, see Joint Cybersecurity Advisory AA21-048A: AppleJeus: Analysis of North Korea's Cryptocurrency Malware at https://www.us-cert.cisa.gov/ncas/alerts/AA21-048A.
There have been multiple versions of AppleJeus malware discovered since its initial discovery in August 2018.
In most versions, the malware appears to be from a legitimate-looking cryptocurrency trading company and website, whereby an unsuspecting individual downloads a third-party application from a website that appears legitimate.
The U.S. Government has identified AppleJeus malware version—JMT Trading—and associated IOCs used by the North Korean government in AppleJeus operations.
JMT Trading malware, discovered by a cybersecurity company in October 2019, is a legitimate-looking cryptocurrency trading software that is marketed and distributed by a company and website—JMT Trading and jmttrading[.
For a downloadable copy of IOCs, see: MAR-10322463-2.v1.stix.
This Windows program from the JMTTrade GitHub site is a Windows MSI Installer.
The installer looks legitimate and previously had a valid digital signature from Comodo (Sectigo).
The signature was signed with a code signing certificate purchased by the same user as the SSL certificate for "jmttrading.org."
Immediately after installation, the installer launches "CrashReporter.exe" with the “Maintain” parameter.
Figure 1 - Screenshot of the JMTTrader Installation.
Whois for jmttrading.org had the following information on October 11, 2019:
			Registrar: NameCheap
			Created: July 11, 2019
			Expires: July 11, 2020
			Updated: September 10, 2019
This site contained a “Download from GitHub” button which takes the user to the JMTTrader GitHub page (github.com/jmttrading/JMTTrader/releases) where both Windows and OSX versions of JMTTrader were available for download.
There are also zip and a tar.gz files containing the source code.
JMT Trading has a legitimately signed Sectigo SSL certificate.
The SSL certificate was “Domain Control Validated," just as the Celas LLC certificate for AppleJeus variant 1.
The domain was registered at the IP address 198.187.29.20 with ASN 22612.
This file is a 32-bit Windows executable contained within the Windows MSI Installer "JMTTrader_Win.msi."
When executed, "JMTTrader.exe" asks for the user’s exchange, and then loads a legitimate cryptocurrency trading platform with no signs of malicious activity.
"JMTTrader.exe" is similar in appearance to version 1 and QT Bitcoin Trader.
QtBitcoinTraderClass
			July IGHOR (note: Ighor July is one of the developers of QT Bitcoin Trader)
			--End similarities--
			The strings also reference the name “Gary Mendez” with email garyhmendez@yahoo.com as the author of "JMTTrader.exe."
There is also reference to an additional GitHub repository under the name Gary Mendez “github.com/garymendez/JMTTrader/issues."
While the JMTTrader application is likely a modification of QT Bitcoin Trader, the legitimate QT Bitcoin Trader for Windows is not available for download as an MSI, but only as a Windows portable executable.
This is a singular file named "QtBitcoinTrader.exe" and does not install or run any additional programs.
The JMTTrader MSI contains "JMTTrader.exe," the modified version of QT Bitcoin Trader, as well as the additional "CrashReporter.exe" (9bf8e8ac82b8f7c3707eb12e77f94cd0e06a972658610d136993235cbfa53641) executable not included with the original QT Bitcoin Trader.
Figure 2 - Screenshot of the JMTTrader Application.
This file is a 32-bit Windows executable contained within the Windows MSI Installer "JMTTrader_Win.msi."
Unlike the first version of the malware, "CrashReporter.exe" is installed in the “C:\Users\<username>\AppData\Roaming\JMTTrader," which is a different folder than "JMTTrader.exe."
"CrashReporter.exe" is heavily obfuscated with the ADVObfuscation library, which has been renamed “snowman” by the malware writer.
Due to this obfuscation, detailed functionality can be difficult to determine to the extent of the non-obfuscated "Updater.exe" binary.
At launch, "CrashReporter.exe" first checks for the “Maintain” parameter and if not found, exits the program to likely evade detection in a sandbox environment.
The malware collects basic victim information and encrypts the data with the hardcoded XOR key “X,%`PMk--Jj8s+6=15:20:11."
The encrypted data is sent to “hxxps[:]//beastgoc.com/grepmonux.php” with a multipart form data separator “--wMKBUqjC7ZMG5A5g."
The malware’s capabilities include reading/writing itself to various directories, querying/writing to the registry, searching for files, extract/decode payload, and terminating processes.
"CrashReporter.exe" also creates a scheduled SYSTEM task named "JMTCrashReporter," which runs the "CrashReporter.exe" program with the “Maintain” parameter at the login of any user.
Figure 3 - Hard-coded XOR key and XOR encryption.
Figure 4 - Screenshot of the "JMTCrashReporter" scheduled task.
Whois information for the domain beastgoc.com on October 11, 2019 was as follows:
			Registrar: NameCheap
			Created Date: July 19, 2019
			Expiration Date: July 19, 2020
The site "beastgoc.com" had as valid digital signature signed by Sectigo.
This is a “Domain Control Validated” signature, which is the lowest level of validation.
The domain was registered at the IP address 185.228.83.32 with ASN 205406.
This OSX program from the JMTTrader GitHub is an Apple DMG installer.
The OSX program has very similar functionality to the Windows program, but does not have a digital signature.
Again, the installer appears to be legitimate and installs both JMTTrader in the “/Applications/JMTTrader.app/Contents/MacOS/” folder and a hidden program named “.CrashReporter” in the “/Applications/JMTTrader.app/Contents/Resources/” folder.
The installer contains a postinstall script (see Figure 5).
This postinstall script has similar functionality to the postinstall script of the first version but has a few additional features.
It still moves the hidden plist file (.com.jmttrading.plist) to the LaunchDaemons folder, but also changes the file permissions on the plist.
Once in the LaunchDaemons folder, this program will be ran on system load as root for every user, which will launch the CrashReporter program with the Maintain parameter.
The postinstall script also moves the “.CrashReporter” program to a new location “/Library/JMTTrader/CrashReporter” and makes it executable.
Like CelasTradePro, as the LaunchDaemon will not run automatically after the plist file is moved, the postinstall script then launches the CrashReporter program with the Maintain parameter and runs it in the background (&).
The package also has “Developed by Gary Mendez.
JMTTrading Group” in the Info.plist properties file.
Figure 5 - Screenshot of the postinstall script included in OSX JMTTrader installer.
Figure 6 - Screenshot of the "com.jmttrading.plist" file.
This OSX sample was contained within Apple DMG Installer "JMTTrader_Mac.dmg."
When exexuted, JMTTrader has identical functionality and appearance to the Windows JMTTrader.exe.
It asks for the user’s exchange and loads a legitimate cryptocurrency trading application with no signs of malicious activity.
While the appearance has changed slightly from the CelasTradePro application, JMTTrader is close in appearance to both CelasTradePro and QT Bitcoin Trader, and is likely a modification of the OSX QT Bitcoin Trader.
User-Agent: Qt Bitcoin Trader v1.40.42
			July IGHOR (note: Ighor July is one of the developers of QT Bitcoin Trader)
			--End similarities--
			The strings also reference the name “Gary Mendez” with email garyhmendez@yahoo.com as the author of JMTTrader.exe.
There is also reference to an additional GitHub repository under the name Gary Mendez “github.com/garymendez/JMTTrader/issues."
While the JMTTrader application is likely a modification of QT Bitcoin Trader, the legitimate QT Bitcoin Trader DMG for OSX does not contain the postinstall script nor the plist file which creates a LaunchDaemon.
When executed, only QTBitcoinTrader will be installed, and no additional programs will be created, installed, or launched.
In contrast, the JMTTrader DMG contains the CelasTradePro OSX executable, the modified version of QT Bitcoin Trader, as well as the additional CrashReporter OSX executable not included with the original QT Bitcoin Trader.
This OSX sample was contained within Apple DMG Installer "JMTTrader_Mac.dmg."
CrashReporter likely functions very similarly to the Windows CrashReporter.exe program, but unlike the Windows program, it is not obfuscated.
This lack of obfuscation makes it easier to determine the program’s functionality in detail.
Upon launch, the malware checks for the “Maintain” parameter, and will exit if the parameter is not found, likely to avoid sandbox analysis.
CrashReporter then creates a randomly generated token (identifier) and collects the binary’s version and process ID to send to the server.
This data is XOR encrypted with the hard-coded key “X,%`PMk--Jj8s+6=\x02” (last value is a non-printable ASCII character which is hexadecimal \x02).
While the key is different than the XOR key for the Windows sample, the first 16 bytes are the same.
The encrypted data is sent to the same C2 server as the Windows sample at hxxps[:]//beastgoc.com/grepmonux.php with the multipart data form separator “jGzAcN6k4VsTRn9”.
CrashReporter also has a hard-coded user-agent string: “Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Safari/537.36” along with other hard-coded values sent with the data including “token," “query," and “mont.jpg."
If CrashReporter receives a response with the HTTP code 200 (successful), it will invoke another function which will wait for tasking from the C2 server.
When a tasking is received, the function decrypts the data with the same hardcoded XOR key and processes the tasking.
It is likely that the functionality of the Windows CrashReporter.exe is the same as this OSX malware, as the original AppleJeus had the same functionality on both operating systems.
Figure 7 - Screenshot of the maintain parameter verification in CrashReporter.
Figure 8 - Screenshot of the hard-coded XOR key and XOR encryption.
Figure 9 - Screenshot of various hard-coded values in CrashReporter.
Soon after October 11, 2019, the files on GitHub were updated to clean, non-malicious installers.
Then on October 13, 2019, a different cyber security organization published an article detailing the OSX JMTTrader, and soon after the C2 "beastgoc.com" went offline.
There is not a confirmed sample of the payload to analyze at this point.
CISA recommends that users and administrators consider using the following best practices to strengthen the security posture of their organization's systems.
Any configuration changes should be reviewed by system owners and administrators prior to implementation to avoid unwanted impacts.
Additional information on malware incident prevention and handling can be found in National Institute of Standards and Technology (NIST) Special Publication 800-83, "Guide to Malware Incident Prevention & Handling for Desktops and Laptops".
CISA continuously strives to improve its products and services.
You can help by answering a very short series of questions about this product at the following URL: https://us-cert.cisa.gov/forms/feedback/
A Malware Initial Findings Report (MIFR) is intended to provide organizations with malware analysis in a timely manner.
In most instances this report will provide initial indicators for computer and network defense.
To request additional analysis, please contact CISA and provide information regarding the level of desired analysis.
A Malware Analysis Report (MAR) is intended to provide organizations with more detailed malware analysis acquired via manual reverse engineering.
To request additional analysis, please contact CISA and provide information regarding the level of desired analysis.
Can I edit this document?
This document is not to be edited in any way by recipients.
All comments or questions related to this document should be directed to the CISA at 1-888-282-0870 or CISA Service Desk.
Can I submit malware to CISA?
Malware samples can be submitted via three methods:
CISA encourages you to report any suspicious activity, including cybersecurity incidents, possible malicious code, software vulnerabilities, and phishing-related scams.
Reporting forms can be found on CISA's homepage at www.cisa.gov.
This product is provided subject to this Notification and this Privacy & Use policy.
We recently updated our anonymous product survey; we'd welcome your feedback.
Receive security alerts, tips, and other updates.
CISA is part of the Department of Homeland Security
