An official website of the United States government Here's how you know
This report is provided "as is" for informational purposes only.
The Department of Homeland Security (DHS) does not provide any warranties of any kind regarding any information contained herein.
The DHS does not endorse any commercial product or service referenced in this bulletin or otherwise.
This document is marked TLP:WHITE--Disclosure is not limited.
Sources may use TLP:WHITE when information carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release.
Subject to standard copyright rules, TLP:WHITE information may be distributed without restriction.
For more information on the Traffic Light Protocol (TLP), see http://www.us-cert.gov/tlp.
This Malware Analysis Report (MAR) is the result of analytic efforts between Department of Homeland Security (DHS), the Federal Bureau of Investigation (FBI), and the Department of Defense (DoD).
Working with U.S. Government partners, DHS, FBI, and DoD identified Trojan malware variants used by the North Korean government.
This malware variant has been identified as CROWDEDFLOUNDER.
The U.S. Government refers to malicious cyber activity by the North Korean government as HIDDEN COBRA.
For more information on HIDDEN COBRA activity, visit https[:]//www[.]us-cert.gov/hiddencobra.
DHS, FBI, and DoD are distributing this MAR to enable network defense and reduce exposure to North Korean government malicious cyber activity.
This MAR includes malware descriptions related to HIDDEN COBRA, suggested response actions and recommended mitigation techniques.
Users or administrators should flag activity associated with the malware and report the activity to the Cybersecurity and Infrastructure Security Agency (CISA) or the FBI Cyber Watch (CyWatch), and give the activity the highest priority for enhanced mitigation.
This report analyzes a Themida packed 32-bit Windows executable, which is designed to unpack and execute a Remote Access Trojan (RAT) binary in memory.
This application is designed to accept arguments during execution or can be installed as a service with command line arguments.
It is designed to listen as a proxy for incoming connections containing commands or can connect to a remote server to receive commands.
For a downloadable copy of IOCs, see MAR-10265965-3.v1.stix.
This application is a Themida packed 32-bit Windows executable, which is designed to unpack and execute a RAT binary in memory.
This application is designed to accept arguments during execution or can be installed as a service with command line arguments.
When executed, the application is designed to open the Windows Firewall on the victimâ€™s machine to allow for incoming and outgoing connections from the victim system.
The firewall is modified using a "netsh firewall add portopening" command (Figure 2).
Static analysis indicates this malware may be utilized to listen as a proxy for incoming connections containing commands or can connect to a remote server to receive commands.
The following command line arguments are utilized to control the RAT functionality:
			--Begin RAT command line arguments--
			-p: You can use the -p command line argument to force the malware to listen on a specific port.
Example: malware.exe -p 8888
			-h: You can use the -h CLI to force the malware to connect to a remote host and port.
Example: malware.exe -h <url_string>:8888
			Note: <url_string> can be either a fully qualified domain name or an Internet Protocol (IP) address.
--End RAT command line arguments--
			The RAT uses a rotating exclusive or (XOR) cryptographic algorithm to secure its data transfers and command-and-control (C2) sessions (Figure 1).
Note: A rotating XOR cipher will be used to secure all C2 traffic sent and received from the external C2 server.
Although the malware appears to expect a numeric IP address with the -h argument, it will also accept a string Uniform Resource Locator (URL) value.
If a URL string is provided (i.e.
domain.com) the malware will then query this address using the Win32 API getaddrinfo().
If this call succeeds, an IP address will be returned and the malware will attempt to connect to that IP address.
If the call to getaddrinfo() fails the malware will hash this domain using the MD5 hashing algorithm, resulting in a 16 byte hash value.
The malware will then take bytes 4 through 8 of this hash value and XOR them with a four byte value.
The resultant four byte value will then be treated as a numeric IP address.
The malware will then attempt to connect to this newly generated IP address.
Note: all of the command line executables referenced within this product generate and connect to an IP address generated from the provided URL string if the call to getaddrinfo() against the provided URL fails.
Figure 1 - XOR based cipher utilized by RAT to secure traffic between itself and the operator/C2 server.
Figure 2 - Malware loading the command to open the firewall.
Figure 3 - This structure is utilized to parse the proxy port or remote C2 server from the command line arguments.
CISA recommends that users and administrators consider using the following best practices to strengthen the security posture of their organization's systems.
Any configuration changes should be reviewed by system owners and administrators prior to implementation to avoid unwanted impacts.
Additional information on malware incident prevention and handling can be found in National Institute of Standards and Technology (NIST) Special Publication 800-83, "Guide to Malware Incident Prevention & Handling for Desktops and Laptops".
CISA continuously strives to improve its products and services.
You can help by answering a very short series of questions about this product at the following URL: https://us-cert.gov/forms/feedback/
A Malware Initial Findings Report (MIFR) is intended to provide organizations with malware analysis in a timely manner.
In most instances this report will provide initial indicators for computer and network defense.
To request additional analysis, please contact CISA and provide information regarding the level of desired analysis.
A Malware Analysis Report (MAR) is intended to provide organizations with more detailed malware analysis acquired via manual reverse engineering.
To request additional analysis, please contact CISA and provide information regarding the level of desired analysis.
Can I edit this document?
This document is not to be edited in any way by recipients.
All comments or questions related to this document should be directed to the CISA at 1-888-282-0870 or soc@us-cert.gov.
Can I submit malware to CISA?
Malware samples can be submitted via three methods:
CISA encourages you to report any suspicious activity, including cybersecurity incidents, possible malicious code, software vulnerabilities, and phishing-related scams.
Reporting forms can be found on CISA's homepage at www.us-cert.gov.
This product is provided subject to this Notification and this Privacy & Use policy.
We recently updated our anonymous product survey; we'd welcome your feedback.
Receive security alerts, tips, and other updates.
CISA is part of the Department of Homeland Security
