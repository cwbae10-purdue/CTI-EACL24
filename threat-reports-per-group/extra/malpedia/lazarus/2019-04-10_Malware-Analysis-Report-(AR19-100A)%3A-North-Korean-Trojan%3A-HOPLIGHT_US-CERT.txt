An official website of the United States government Here's how you know
This report is provided "as is" for informational purposes only.
The Department of Homeland Security (DHS) does not provide any warranties of any kind regarding any information contained within.
The DHS does not endorse any commercial product or service, referenced in this bulletin or otherwise.
This document is marked TLP:WHITE.
Sources may use TLP:WHITE when information carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release.
Subject to standard copyright rules, TLP:WHITE information may be distributed without restriction.
For more information on the Traffic Light Protocol, see http://www.us-cert.gov/tlp.
This Malware Analysis Report (MAR) is the result of analytic efforts between Department of Homeland Security (DHS) and the Federal Bureau of Investigation (FBI).
Working with U.S. Government partners, DHS and FBI identified Trojan malware variants used by the North Korean government.
This malware variant has been identified as HOPLIGHT.
The U.S. Government refers to malicious cyber activity by the North Korean government as HIDDEN COBRA.
Seven of these files are proxy applications that mask traffic between the malware and the remote operators.
The proxies have the ability to generate fake TLS handshake sessions using valid public SSL certificates, disguising network connections with remote malicious actors.
One file contains a public SSL certificate and the payload of the file appears to be encoded with a password or key.
The remaining file does not contain any of the public SSL certificates, but attempts outbound connections and drops four files.
The dropped files primarily contain IP addresses and SSL certificates.
For a downloadable copy of IOCs, see:
This artifact is a malicious PE32 executable.
The malware uses a public SSL certificate for secure communication.
This certificate is from www.naver.com.
These IP addresses are referenced in 'udbcgiut.dat' below.
Therefore, only capability that is unique will be described for the following four artifacts.
Both connection attempts are over TCP Port 443.The two IP addresses above, as well as the IP addresses 181.39.135.126 and 197.211.212.59 are hard-coded into the malware.
However, only connections to the first two IP addresses were attempted during analysis.
This IP address is listed in the file 'udbcgiut.dat'.
Outbound SSL connection attempts are made to this IP by Malware2.exe, Malware3.exe, and Malware5.exe.
The domain, zol-ad-bdc.zol.co.zw is associated with the IP address, however, no DNS query is made for the name.
inetnum:     181.39.135.120/29status:     reallocatedowner:     Clientes Guayaquilownerid:     EC-CLGU1-LACNICresponsible: Tomislav Topicaddress:     Kennedy Norte Mz.
This IP address is listed in the file 'udbcgiut.dat'.
Outbound SSL connection attempts are made to this IP by Malware2.exe, Malware3.exe, and Malware5.exe.
No domain is associated with the IP address.
This IP address is listed in the file 'udbcgiut.dat'.
Outbound SSL connection attempts are made to this IP by Malware2.exe, Malware3.exe, and Malware5.exe.
The domain, mail.everzone.co.kr is associated with the IP address, however, no DNS query is made for the name.
This IP address is listed in the file 'udbcgiut.dat'.
Outbound SSL connection attempts are made to this IP by Malware2.exe, Malware3.exe, and Malware5.exe.
No domain is associated with the IP address.
'udbcgiut.dat' is dropped by three of the four PE32 executables.
The socket pairs remain the same for all instances of the malware.For the PE32 executables, 'udbcgiut.dat' was dropped in the victim's profile at %AppData%\Local\Temp.
For the 64bit executables, 'udbcgiut.dat' was dropped in C:\Windows.
This artifact is a malicious PE32 executable with similar characteristics of those described in 23E27E5482E3F55BF828DAB885569033 above.This artifact appears to be named 'lamp.exe'.
The malware contains the following debug pathway:---Begin Debug Pathway---Z:\Develop\41.LampExe\Release\LampExe.pdb---End Debug Pathway---
This artifact is a malicious PE32 executable with similar characteristics of those described in 23E27E5482E3F55BF828DAB885569033 above.This program attempts to initiate a TLS Handshake to the four IP/Port pairs listed in 'udbcgiut.dat'.
If the program is unable to establish a connection, the file 'udbcgiut.dat' is deleted.After 'udbcgiut.dat' is deleted, an outbound SSL connection is made to 81.94.192.10.
A high port to high port connection attempt is made to this IP address from 'Malware5.dll'.
No domain is associated with the IP address.
This artifact is a malicious x64 executable with similar characteristics of those described in 23E27E5482E3F55BF828DAB885569033 above.In addition to the capabilities described above, this variant will hook the Windows Local Security Authority (lsass.exe).
'lsass.exe' will check the registry for the data value 'rdpproto' under the key SYSTEM\CurrentControlSet\Control\Lsa Name: Security Packages.
If not found, this value is added by 'lsass.exe'.Next, the malware will drop the embedded file, 'rdpproto.dll' into the %System32% directory.The file, 'udbcgiut.dat' is then written to C:\Windows.
Outbound connection attempts are made to the socket pairs found within this file as described above.
"rdpproto.dll" is dropped into the %System32% directory by 868036E102DF4CE414B0E6700825B319.
A high port to high port connection attempt is made to this IP address from 'Malware2.dll'.
No domain is associated with the IP address.
A high port to high port connection attempt is made to this IP address from 'Malware2.dll'.
No domain is associated with the IP address.
A high port to high port connection attempt is made to this IP address from 'Malware2.dll'.
No domain is associated with the IP address.
A high port to high port connection attempt is made to this IP address from 'Malware2.dll'.
No domain is associated with the IP address.
A high port to high port connection attempt is made to this IP address from 'Malware2.dll'.
No domain is associated with the IP address.
A high port to high port connection attempt is made to this IP address from 'Malware2.dll'.
No domain is associated with the IP address.
A high port to high port connection attempt is made to this IP address from 'Malware2.dll'.
No domain is associated with the IP address.
A high port to high port connection attempt is made to this IP address from 'Malware2.dll'.
No domain is associated with the IP address.
A high port to high port connection attempt is made to this IP address from 'Malware2.dll'.
No domain is associated with the IP address.
A high port to high port connection attempt is made to this IP address from 'Malware2.dll'.
No domain is associated with the IP address.
This artifact is a malicious 64bit Windows dynamic library called 'Vote_Controller.dll'.
This artifact is 64bit Windows dynamic library file which shares many of the same characteristics and name (Vote_Controller.dll) as 42682D4A78FE5C2EDA988185A344637D above.When this library is loaded it will look for the file 'udbcgiut.dat' in C:\WINDOWS.
Recent malware variants have been observed modifying the MOF files within the system registry to run specific commands and create persistency on the system.Of note, the paravirtual SCSI driver for VMWare Tools is also located in HKLM\Software\WBEM\WDM within a virtual image.
When this driver is recompiled by the malware, VMWare Tools no longer works.
It cannot be determined if this is an intentional characteristic of the malware to hinder analysis, or simply a symptom of the method used to establish persistence.
This artifact is a malicious PE32 executable.
Similar to 5C3898AC7670DA30CF0B22075F3E8ED6 above, the program writes the file 'udbcgiut.dat' to the victim's profile at %AppData/Local/Temp%.
A second file is written to the victim's profile in the %AppData/Local/VirtualStore/Windows% directory and identified as 'MSDFMAPI.INI'.
'MSDFMAPI.INI' is also written to C:\WINDOWS.
More information on the content of these files is below.61E3571B8D9B2E9CCFADC3DDE10FB6E1 attempts the same outbound connections as 5C3898AC7670DA30CF0B22075F3E8ED6, however the file does not contain any of the public SSL certificates referenced above.
This artifact is a malicious 32bit Windows dynamic library.
'UDPTrcSvc.dll' is identified as the 'Network UDP Trace Management Service'.
The following description is provided:---Begin Service Description---Network UDP Trace Management Service Hosts TourSvc Tracing.
If this service is stopped, notifications of network trace will no longer function and there might not be access to service functions.
'MSDFMAPI.INI' is written to C:\WINDOWS and to %UserProfile\AppData\Local\VirtualStore\Windows%.
During analysis, two NULL characters were written to the file.
The purpose of the file has not been determined.
This artifact contains a similar public SSL certificate from naver.com, similar to many of the files above.
The payload of the file appears to be encoded with a password or key.
No context was provided with the file's submission.
CISA would like to remind users and administrators to consider using the following best practices to strengthen the security posture of their organization's systems.
Any configuration changes should be reviewed by system owners and administrators prior to implementation to avoid unwanted impacts.
Additional information on malware incident prevention and handling can be found in NIST's Special Publication 800-83, Guide to Malware Incident Prevention & Handling for Desktops and Laptops.
CISA continuously strives to improve its products and services.
You can help by answering a very short series of questions about this product at the following URL: https://us-cert.gov/forms/feedback/
A Malware Initial Findings Report (MIFR) is intended to provide organizations with malware analysis in a timely manner.
In most instances this report will provide initial indicators for computer and network defense.
To request additional analysis, please contact US-CERT and provide information regarding the level of desired analysis.
A Malware Analysis Report (MAR) is intended to provide organizations with more detailed malware analysis acquired via manual reverse engineering.
To request additional analysis, please contact US-CERT and provide information regarding the level of desired analysis.
Can I edit this document?
This document is not to be edited in any way by recipients.
All comments or questions related to this document should be directed to CISA at 1-888-282-0870 or soc@us-cert.gov.
Can I submit malware to CISA?
Malware samples can be submitted via three methods:
CISA encourages you to report any suspicious activity, including cybersecurity incidents, possible malicious code, software vulnerabilities, and phishing-related scams.
Reporting forms can be found on CISA/US-CERT's homepage at www.us-cert.gov.
This product is provided subject to this Notification and this Privacy & Use policy.
We recently updated our anonymous product survey; we'd welcome your feedback.
Receive security alerts, tips, and other updates.
CISA is part of the Department of Homeland Security
