Signature: Microsoft Visual C# v7.0 / Basic .NET
Link to Download Sample: Any.Run
njRAT is a remote access Trojan.
It is one of the most widely accessible
I came across this while going through
Any.Run trends and thought to download sample for analysis.
I have disassembled executable file using dnSpy.
It makes easy to analyse the code.
Stub shows entry point where I can
put breakpoint to start the debugging to analyse the behavior
I start debugging and put break point at entry point.
Ko() function first check the list predefined process running on victim’s
 machine if they are, the malware executable
In this case, wireshark was running in background.
It stops calling assembly and execution process.
To avoid call to CsAntiProcess which look for the running process, I change the value of anti_CH bool variable value to
(Value of variable can change from Locals windows)
CsAntiProcess handler look for the process and if its there , it stops execution.
The list of process mentioned
NOTE: To bypass process check, I also changed the names of process e.g.
Wireshark.exe to wk.exe and procexp.exe to prex.exe which helped to by pass process check when I executed malware without debugging in dnSpy because process names are hard coded.
EXE is a string variable initialized as svchost.exe.
It could be named svchost.exe (Windows Service Host) to create
confusion and it make difficult to differentiate its malicious without analyzing its location and properties.
It also drops Tools.exe at location C:\
File also drop at location
and add to registry HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run
Adding this registry value, the executable will execute everytime when user logon to the system.
Dropping file in this case is copying itself to the three different location.
As all three files have different names but same hash and code.
In code, IP address along with the port 7777 and executable names are initialized.
C2 Server IP Address details:
svchost.exe has sent TCP segment with SYN control bits to C2 server but there is no response from the server.
the IP address exists and IP location is Russia.
I used netstat to check the tcp connection.
Comments and suggestions are welcome.
[…] Article Link: https://malwr-analysis.com/2020/06/21/njrat-malware-analysis/ […]
Great Writeup..
Can you please explain if we want to recommend this to our client for removal of this type of malware.
How we can implement remediation..
Monitor traffic to C2 server to confirm no more infection exist.
You can email if have any doubt @ anurag@malwr-analysis.com
This was a great help for me.
Do we have to add in Firewall/ IDS Server to block it?
IDS will help to detect attacks based on signature (behavior).
There are different types of IDS available.
But I am not the right person to suggest whats best either in Firewall or IDS.
Fill in your details below or click an icon to log in:


			You are commenting using your WordPress.com account.
( Log Out / 
				Change )


			You are commenting using your Google account.
( Log Out / 
				Change )


			You are commenting using your Twitter account.
( Log Out / 
				Change )


			You are commenting using your Facebook account.
( Log Out / 
				Change )
 Notify me of new comments via email.
 Notify me of new posts via email.
This site uses Akismet to reduce spam.
Learn how your comment data is processed.
Donate $5 to buy me a coffee so I have the fuel I need to keep producing great content!
Enter your email address to follow this blog and receive notifications of new posts by email.
