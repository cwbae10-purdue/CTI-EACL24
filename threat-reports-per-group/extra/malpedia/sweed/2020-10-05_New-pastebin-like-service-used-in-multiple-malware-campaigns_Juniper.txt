Juniper Threat Labs identified several malware campaigns that rely on a pastebin-like service for its infection chain.
The domain in question is paste.nrecom.net.
The attacks usually start as a phishing email and, when a user is tricked into executing the malware, it downloads the succeeding stage of the malware from paste.nrecom.net and loads it into the memory without writing to disk.
Using a legitimate web-service for the malware infrastructure is not new, as we have seen APT group FIN6 using pastebin to host parts of the infection chain and Rocke using it for command and control.
Although using legitimate web services is not novel, this is the first time that we have seen threat actors use paste.nrecom.net.
Among the malware we have identified are AgentTesla, LimeRAT, Ransomware and Redline Stealer.
Paste.nrecom has been in service since May 2014.
If you are not familiar with pastebin, it is a service where you can post your code or text data with the intent of sharing it with others.
Paste.nrecom does the same thing and it also offers an API that allows scripting.
This is advantageous to threat actors as they can easily insert and update data programmatically.
This service is powered by Stikked, which is an open-source PHP based pastebin.
Because it is a text-only service, one would think that it cannot host an executable file (binary data) into it.
However, binary data can be represented as a text file by simply encoding it.
The common encoding method is using base64.
That is exactly what the threat actors did in this case.
To add another layer of obfuscation, they encrypt the binary data with a XOR key.
The following file, for example, is encrypted with XOR key, 0x02.
From September 21, 2020, we have seen several malware families taking advantage of this service and quickly ramped up.
The attack usually starts with a phishing email that includes an attachment, such as a document, archive or an executable.
When a user is tricked into installing the malicious attachment (first stage), it downloads the next stages from paste.nrecom.net.
We have also seen malware hosting their configuration data in the same service.
Agent Tesla is a spyware that is capable of stealing personal data from web browsers, mail clients and FTP servers.
It can also collect screenshots, videos and capture clipboard data.
Recent versions of this malware are also capable of stealing personal data from VPN clients.
It is being sold on the underground markets for as low as $15 and could go up to $70 depending on the additional features.
Agent Tesla is among the most active malware using this pastebin-like service.
Campaigns usually start with a phishing email with a malicious attachment.
Based on the samples we found, these campaigns target multiple industries related to shipping, supply chain and banks.
In some cases, the attachments are archives, such as .iso, .rar or .uue like below:
As you can see from the chain, there are two requests to paste.nrecom because it divides the Agent Tesla payload into two.
The first request is the first half of the file and the second request makes the second half.
This technique makes it harder for security solutions to analyze the payload.
Below are email attachments and files inside some email attachments that we have found to install Agent Tesla using paste.nrecom.
Emirate bank TT copy 2020-09-20 at 07.30.55.uue
PO#150367285 SECONDO VERGANI SPA Ref#BK043383.exe
APROBACION DE TRANSFERENCIA INUSUAL REALIZADA EXITOSAMENTE.tar
In some cases, the attached files are Office Documents that download the Agent Tesla loader.
W3Cryptolocker is a relatively new ransomware.
Based on our telemetry, this ransomware surfaced in July 2020.
We will call this malware W3Cryptolocker, based on a string found in its code.
The loader was hosted on a potentially hacked site, italake.com.
It will encrypt all files in all drives except for files having “.xls” extension and folders having the following strings:
It adds an extension .xls for encrypted files.
After it is done encrypting each folder, it creates a “Read_Me.txt” file on each folder with the following message.
]su/2QstD5 leads you to a freshdesk support site, bit7.freshdesk.com.
Redline Stealer is a malware that surfaced around March 2020 and it was reported to have targeted healthcare and manufacturing industries in the United States.
This malware is found being advertised on forums with several pricing options starting from $100/month subscription.
It has the following functionality:
The sample we found poses as a Bitcoin Miner archived into a RAR file.
The archive contains an executable, MinerBitcoin.exe, that downloads the Redline Stealer payload from paste.nrecom.net.
LimeRAT is a remote administration trojan coded in .NET and is open source.
It was a malware used to target Colombian government institutions by the APT-C-36 group.
Among its many capabilities, it can be used as:
Another sample we found is aae2e0d0792e22164b3c81d0051c5f94a293bae69e7aac5cc4ad035860dbf802.
At the time of this analysis, this sample still has zero VT detections.
It downloads the LimeRAT from https://paste[.]nrecom[.
Using legitimate web-services like pastebin or paste.nrecom for malware infrastructure gives cybercriminals an advantage, as these services cannot be easily taken down due to their legitimate use.
We recommend Security Operations to add paste.nrecom to potentially web services being abused for malicious purposes.
It is recommended to monitor web-services like this one for suspicious content particularly binary data encoded in base64.
Juniper’s Encrypted Traffic Insights capability on the SRX NGFW does detect the malicious TLS connections to paste.nrecom.net as malicious using machine learning as seen in the screenshot below for W3Cryptolocker loader.
Juniper Advanced Threat Protection (ATP) detects these threats.
