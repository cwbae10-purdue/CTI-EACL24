Get access to immediate incident response assistance.
Attracting more than a half-million annual readers, this is the security community's go-to destination for technical breakdowns of the latest threats, critical vulnerability disclosures and cutting-edge research.
The use of novel disk image files to encapsulate malware distributed via spam has been a theme that we have highlighted over the past couple of years.
As anticipated, we have seen more disk image file formats being used, in addition to .ISO, .IMG, and .DAA which we blogged about.
We recently spotted another file format being used.
These spams, spoofing courier companies, contain a malicious WIM (Windows Imaging Format) file disguised as an invoice or consignment note.
WIM is a file-based disk image format developed by Microsoft.
The file format serves to deploy Windows software components and updates ever since Windows Vista.
This format uses a ".wim" extension and its content can be extracted using archiving tools like 7Zip, PowerISO, and PeaZip.
Below are some samples from this campaign.
The attachments, although they have a ‘.wim.001’ file extension which denotes that they are the first part of a larger WIM file, have the complete file structure of a WIM file.
Using the ImageX tool, we verified that all the WIM attachments we collected are not compressed and have one file only.
Opening the WIM files in a hex editor, its immediately noticeable that an executable file is hiding in them.
Using the archiving tool 7Zip as displayed in Fig.
3, the EXE file bearing the same name as its WIM container can be extracted.
All the WIM files we gathered from our samples contain Agent Tesla malware.
This threat is a Remote Access Trojan (RAT) written in .Net which can take full control over a compromised system and can exfiltrate data via HTTP, SMTP, FTP, and Telegram.
In 2020, Agent Tesla was one of the predominant RATs and early this year, we reported that this malware is still actively getting distributed in spam emails.
Encapsulating malware in an unusual archive file format is one of the common ways to bypass gateways and scanners.
However, this strategy also poses a hurdle – the target system must recognize the file type or at least have a tool which can unpack and process the file.
In contrast to the more popular .IMG and .ISO disk image files, WIM files are not supported by Windows built-in ability to mount disk image files.
Moreover, the other popular archive utilities WinRAR and WinZip do not recognize the WIM disk image.
WIM files can be processed with the widely used 7Zip.
In terms of suspiciousness, an inbound email containing a WIM file is not usual and should raise a few flags.
Administrators could look to block these outright.
Trustwave MailMarshal detects these threats bundled inside unusual disk imaging containers using a combination of its unpacking engine and its multi-layered threat detection technology.
Other:DHL Airway 3426983793.tar.001 (782336 bytes)    SHA1: E31107CCE2AA0DCF8B8C064EFEACAD5508C69D29
Sign up to receive the latest security news and trends from Trustwave.
Copyright ©
                         Trustwave Holdings, Inc. All rights reserved.
This is a bot-free zone.
Please check the box to let us know you're human.
Read complimentary reports and insightful stories in the Trustwave Resource Center
One of our sales specialists will be in touch shortly.
Read complimentary reports and insightful stories in the Trustwave Resource Center
