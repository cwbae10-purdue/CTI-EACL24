
        Network detector for Winnti malware
winnti-detector detects Winnti (as of 2016/2017) communication patterns in network traffic.
It can read PCAPs or listen on a live interface.
Winnti is a malware that is used by some APT groups.
It has been used since at least 2013 and has evolved over time.
You can find some information here
The driver component of Winnti (aka "NdisReroute") is able to reroute network traffic from ports that are already occupied by legit applications to the malware's userspace component.
The first packet of a TCP stream signals the driver that the stream shall be rerouted.
I call such a packet a "Winnti HELO".
It is exactly 16 bytes long and the bytes match the following relation:
winnti-detector uses libnids which you can install with
You can then compile and run winnti-detector
As the usage text suggests, you can use the parameter -l to write syslog entries whenever a match is found.
The program always also outputs findings on stdout.

      Network detector for Winnti malware
