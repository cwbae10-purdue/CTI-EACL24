Kaspersky Lab began this ongoing research in the autumn of 2011.
The subject is a series of targeted attacks against private companies around the world.
In the course of our research we uncovered the activity of a hacking group which has Chinese origins.
This group was named “Winnti”.
According to our estimations, this group has been active for several years and specializes in cyberattacks against the online video game industry.
The group’s main objective is to steal source codes for online game projects as well as the digital certificates of legitimate software vendors.
In addition, they are very interested in how network infrastructure (including the production of gaming servers) is set up, and new developments such as conceptual ideas, design and more.
We weren’t the first to focus on this group and investigate their attacks.
In 2010 US-based HBGary investigated an information security incident related to the Winnti group at one of HBGary’s customers – an American video game company.
In the autumn of 2011, a Trojan was detected on a huge number of computers – all of them linked by the fact that they were used by players of a popular online game.
It emerged that the piece of malware landed on users’ computers as part of a regular update from the game’s official update server.
Some even suspected that the publisher itself was spying on players.
However, it later became clear that the malicious program ended up on the users’ computers by mistake: the cybercriminals were in fact targeting the companies that develop and release computer games.
The computer game publisher whose servers spread the Trojan asked Kaspersky Lab to analyze the malicious program that was found on its update server.
It turned out to be a DLL library compiled for a 64-bit Windows environment and even had a properly signed malicious driver.
The malicious DLL landed on gamers’ computers running under either 32-bit or 64-bit operating systems.
It couldn’t start in 32-bit environments, but it could, under certain conditions, launch without the user’s knowledge or consent in 64-bit environments, though no such accidental launches have been detected.
The DLL contained a backdoor payload, or, to be exact, the functionality of a fully-fledged Remote Administration Tool (RAT), which gave cybercriminals the ability to control the victim computer without the user’s knowledge.
The malicious module turned out to be the first time we saw Trojan applications for the 64-bit version of Microsoft Windows with a valid digital signature.
We had seen similar cases before, but all previous incidents where digital signatures were abused affected only 32-bit applications.
At an early stage of our research, we identified a fair number of similar backdoors, both 32-bit and 64-bit, in our collection of malware samples that were detected under various verdicts.
We grouped them together into a separate family.
Symantec appears to be the first to name these malicious programs; we kept Symantec’s name – Winnti – in the name of the malware family we created: Backdoor.Win32(Win64).Winnti.
As for the people behind these attacks involving this remote administration tool, we ended up calling them “the Winnti group”.
Interestingly, the digital signature belonged to another video game vendor – a private company known as KOG, based in South Korea.
This company’s main business was MMRPG games, exactly the same area as the first victim.
We contacted KOG, whose certificate was used to sign the malicious software, and notified Verisign, which issued the certificate for KOG.
As a result the certificate was revoked.
When we discovered the first stolen digital certificate we didn’t realize that stealing the certificates and signing malware for future attacks against other targets was the preferred method of this group.
Over the next 18 months we discovered more than a dozen similar compromised digital certificates.
Moreover, we found that those digital certificates seemed to have been used in attacks organized by other hacking groups, presumably coming from China.
For example, in an attack against South Korean social networks Cyworld and Nate in 2011 the attackers used a Trojan that was digitally signed using a certificate of from the gaming company YNK Japan Inc.
A digital certificate of the same company was used recently (March 2013) in Trojans deployed against Tibetan and Uyghur activists.
In fact, this story dates back to 2011.
We highly recommend this Norman blogpost about a similar incident: http://blogs.norman.com/2011/security-research/invisible-ynk-a-code-signing-conundrum .
At the same time, in March 2013, Uyghur activists were targeted by other malware, which was digitally signed by another gaming company called MGAME Corp.
We believe that the source of all these stolen certificates could be the same Winnti group.
Either this group has close contacts with other Chinese hacker gangs, or it sells the certificates on the black market in China.
Below is the list of known compromised companies and digital certificates used by the Winnti group in different campaigns:
However, any company with data that can be effectively monetized is at risk from APTs.
This is exactly what we encountered here: it was not a governmental, political, military, or industrial organization but gaming companies that were targeted.
It’s difficult to name all the victims of the Winnti team.
Countries where gaming companies have been affected
Such geographic diversity is hardly surprising.
Often, gaming companies (both publishers and developers) are international, having representatives and offices worldwide.
Also, it is common practice for gaming companies from various regions to cooperate.
The developers of a game may be located in a different country from its publisher.
When a game later reaches markets in regions away from its initial ‘home’, it is often localized and published by other publishers.
In the course of this cooperation, the partner companies often grant each other access to network resources to exchange data associated with the gaming content, including distribution kits, gaming resources, resource assembly kits, etc.
If one company in the network gets infected, it’s easy for the cybercriminals to spread the infection throughout the partnership chain.
Winnti C&Cs Structure
During the investigation, we identified over a hundred malicious programs, every single one compiled to attack a particular company.
Typically, separate C&C domains were assigned to each targeted company.
Virtually all the C&C domains were arranged as follows: a second-level domain was created without a DNS A-record, i.e., there was no IP address assigned to it.
In case there was an A-record, the assigned IP address was typically 127.0.0.1.
It is also noteworthy that some of the second-level domains that the cybercriminals created for their C&C had very similar names to the domain hosting the site of a certain real gaming company.
And the malicious users’ domain was resolved to the same IP address which the site of the real gaming company used.
In any case, the third-level domains resolved to IP addresses assigned to the attackers’ actual C&C servers.
C&C domain naming and resolution
Sometimes the Winnti team registered their C&C units with public hosts.
Judging by the samples identified, these C&C centers were subdomains of such domains as 6600.org, 8866.org, 9966.org or ddns.net.
Sometimes Winnti’s malicious programs had a local IP address, such as 192.168.1.136, specified in their settings for the C&C.
This could mean that at some point of time there was an infected computer that did not have a connection to the Internet, but the cybercriminals needed control over it (it may have been infected while malware was spread via a corporate network).
In this case, the cybercriminals deployed a dedicated local C&C server on another compromised computer within the same local network which did have an Internet connection; via that C&C, the first victim computer could be controlled.
System administrators often try to isolate critical computers from the outside world.
This decreases the probability of haphazard infection, but, apparently, does not always help in a targeted attack.
In the Winnti samples that were detected and analyzed, we found 36 unique C&C domains.
Most probably, this is only a small portion of all existing Winnti C&C domains, as we only managed to obtain some of the samples from this malware family.
This is hardly surprising since these malicious programs are used to execute targeted attacks, so no information is available about many instances of infection; for this reason, we have no way of obtaining samples of the malware used in these undisclosed attacks.
Having searched through subdomains for a total of 12 2nd level domains, we identified 227 “live” 3rd level domains.
Many of them are C&C servers for Winnti-class malware that have hitherto remained unidentified.
Their early domains were involved in spreading rogue antiviruses (FakeAV).
From 2009 onwards, domains began to emerge hosting C&C servers for bots used to infect gaming companies.
Apparently, the cybercriminals graduated to relatively large-scale penetrations into the corporate networks of gaming companies starting from 2010.
Known Malware
The attackers’ favorite tool is the malicious program we called “Winnti”.
It has evolved since its first use, but all variants can be divided into two generations: 1.x and 2.x.
Our publication describes both variants of this tool.
In our report we publish an analysis of the first generation of Winnti.
The second generation (2.x) was used in one of the attacks which we investigated during its active stage, helping the victim to interrupt data transfer and isolate infections in the corporate network.
This incident and our investigation is described in detail here.
In addition to that, we have observed the use of a popular backdoor known as PlugX, which is believed to have Chinese origins.
Previously, this had only been used in attacks against Tibetan activists.
The Commercial Interest
As has been stated above, APTs can target any commercial company if cybercriminals find a way to make a profit from the attack.
So which methods do cybercriminals use to generate illicit earnings from attacks on gaming companies?
Based on the available information, we have singled out three main monetization schemes that could be used by the Winnti team.
The unfair accumulation of in-game currency/”gold” in online games and the conversion of virtual funds into real money.
Theft of source code from the online games server to search for vulnerabilities in games – often linked to point 1.
Theft of source code from the server part of popular online games to further deploy pirate servers.
Let’s look at an example.
During our investigation of an infection at a computer game company, we found that malware had been created for a particular service on the company’s server.
The malicious program was looking for a specific process running on the server, injected code into it, and then sought out two places in the process code where it could conceal call commands for its function interceptors.
Using these function interceptors, the malicious programs modified process data which was processed in those two places, and returned control back.
Thus, the attackers change the normal execution of the server processes.
Unfortunately, the company was not able to share its targeted application with us, and we cannot say exactly how this malicious interference affected gaming processes.
The company concerned told us that the attackers’ aim was to acquire gaming “gold” illegally.
Malicious activity like this has an adverse impact on the game itself, tilting the balance in favor of cheats.
But any changes the Winnti team introduces into the game experience are unlikely to be very noticeable.
After all, maintaining a skillful balance is the main attribute of online games!
Users will simply stop playing if they feel that other players are using non-standard methods to create an advantage beyond normal gameplay or if the game loses its intrinsic competitiveness due to resources or artifacts appearing in the game without the developers’ knowledge.
At the same time the attackers are keen for the game to remain popular; otherwise, they would be unable to effectively turn all the time and effort of infecting a gaming company into financial gain.
Members of the Winnti team are patient and cautious.
Cybercriminals have affected the processes of the online games from the infected companies and stolen money from them for years, but they have found ways of doing this without attracting attention to themselves.
Source of Attacks
So, who is behind Winnti?
While analyzing the malicious files that we detected during our investigation we found some details which may cast some light on the source of the attacks.
As part of our investigation, we monitored exactly what the cybercriminals did on an infected PC.
In particular, they they downloaded an auxiliary program ff._exe to the Config.Msi folder on the infected machine.
This code searches for HTML, MS Excel, MS Word, Adobe, PowerPoint and MS Works documents and text files (.txt) on the hard drive.
Debugging lines were found in ff._exe_ that possibly point to the nationality of the cybercriminals.
They were not immediately noticeable because they looked like this in the editor:

However, during a detailed analysis it emerged that the text is in Chinese Simplified GBK coding.
This is a program with a Chinese interface.
Chinese text was also found in one of the components of the malicious program CmdPlus.dll plug-in:

Translation: The process is complete!!
It would appear that the attackers can at least speak Chinese.
This means the attackers were working on a Korean Windows operating system.
Therefore, we can presume that the attack is not the exclusive work of Chinese-speaking cybercriminals.
Conclusions
Our research revealed long-term oriented large scale cyberespionage campaign of a criminal group with Chinese origins.
These attacks are not new, many other security researchers have published details of various cybercriminal groups coming from China.
The malicious program which we call “Winnti” has evolved significantly since it first emerged; however we classify all its variants in two main generations: 1.x and 2.x.
We have published the technical description of the first generation of Winnti in a separate article .
The second generation (2.x) was used to conduct an attack which we investigated during its active stage.
We successfully prevented data transfer to the cybercriminals’ server and isolated the infected systems in the company’s local network.
The incidents, as well as results of our investigation, are described in the full report on the Winnti group (PDF).
In addition, we discovered that the Winnti group uses a popular backdoor known as PlugX which also has Chinese origins.
This backdoor had previously been seen almost exclusively in attacks targeting Tibetan activists.
It’s tempting to assume that Advanced Persistent Threats (APTs) primarily target high-level institutions: government agencies, ministries, the military, political organizations, power stations, chemical plants, critical infrastructure networks and so on.
However, any company with data that can be effectively monetized is at risk from APTs.
This is exactly what we encountered here: it was not a governmental, political, military, or industrial organization but gaming companies that were targeted.
It’s difficult to name all the victims of the Winnti team.
Countries where the affected companies are located:
Countries where gaming companies have been affected
Such geographic diversity is hardly surprising.
Often, gaming companies (both publishers and developers) are international, having representatives and offices worldwide.
Also, it is common practice for gaming companies from various regions to cooperate.
The developers of a game may be located in a different country from its publisher.
When a game later reaches markets in regions away from its initial ‘home’, it is often localized and published by other publishers.
In the course of this cooperation, the partner companies often grant each other access to network resources to exchange data associated with the gaming content, including distribution kits, gaming resources, resource assembly kits, etc.
If one company in the network gets infected, it’s easy for the cybercriminals to spread the infection throughout the partnership chain.
Winnti C&Cs Structure
During the investigation, we identified over a hundred malicious programs, every single one compiled to attack a particular company.
Typically, separate C&C domains were assigned to each targeted company.
Virtually all the C&C domains were arranged as follows: a second-level domain was created without a DNS A-record, i.e., there was no IP address assigned to it.
In case there was an A-record, the assigned IP address was typically 127.0.0.1.
It is also noteworthy that some of the second-level domains that the cybercriminals created for their C&C had very similar names to the domain hosting the site of a certain real gaming company.
And the malicious users’ domain was resolved to the same IP address which the site of the real gaming company used.
In any case, the third-level domains resolved to IP addresses assigned to the attackers’ actual C&C servers.
C&C domain naming and resolution
Sometimes the Winnti team registered their C&C units with public hosts.
Judging by the samples identified, these C&C centers were subdomains of such domains as 6600.org, 8866.org, 9966.org or ddns.net.
Sometimes Winnti’s malicious programs had a local IP address, such as 192.168.1.136, specified in their settings for the C&C.
This could mean that at some point of time there was an infected computer that did not have a connection to the Internet, but the cybercriminals needed control over it (it may have been infected while malware was spread via a corporate network).
In this case, the cybercriminals deployed a dedicated local C&C server on another compromised computer within the same local network which did have an Internet connection; via that C&C, the first victim computer could be controlled.
System administrators often try to isolate critical computers from the outside world.
This decreases the probability of haphazard infection, but, apparently, does not always help in a targeted attack.
In the Winnti samples that were detected and analyzed, we found 36 unique C&C domains.
Most probably, this is only a small portion of all existing Winnti C&C domains, as we only managed to obtain some of the samples from this malware family.
This is hardly surprising since these malicious programs are used to execute targeted attacks, so no information is available about many instances of infection; for this reason, we have no way of obtaining samples of the malware used in these undisclosed attacks.
Having searched through subdomains for a total of 12 2nd level domains, we identified 227 “live” 3rd level domains.
Many of them are C&C servers for Winnti-class malware that have hitherto remained unidentified.
Their early domains were involved in spreading rogue antiviruses (FakeAV).
From 2009 onwards, domains began to emerge hosting C&C servers for bots used to infect gaming companies.
Apparently, the cybercriminals graduated to relatively large-scale penetrations into the corporate networks of gaming companies starting from 2010.
Known Malware
The attackers’ favorite tool is the malicious program we called “Winnti”.
It has evolved since its first use, but all variants can be divided into two generations: 1.x and 2.x.
Our publication describes both variants of this tool.
In our report we publish an analysis of the first generation of Winnti.
The second generation (2.x) was used in one of the attacks which we investigated during its active stage, helping the victim to interrupt data transfer and isolate infections in the corporate network.
This incident and our investigation is described in detail here.
In addition to that, we have observed the use of a popular backdoor known as PlugX, which is believed to have Chinese origins.
Previously, this had only been used in attacks against Tibetan activists.
The Commercial Interest
As has been stated above, APTs can target any commercial company if cybercriminals find a way to make a profit from the attack.
So which methods do cybercriminals use to generate illicit earnings from attacks on gaming companies?
Based on the available information, we have singled out three main monetization schemes that could be used by the Winnti team.
The unfair accumulation of in-game currency/”gold” in online games and the conversion of virtual funds into real money.
Theft of source code from the online games server to search for vulnerabilities in games – often linked to point 1.
Theft of source code from the server part of popular online games to further deploy pirate servers.
Let’s look at an example.
During our investigation of an infection at a computer game company, we found that malware had been created for a particular service on the company’s server.
The malicious program was looking for a specific process running on the server, injected code into it, and then sought out two places in the process code where it could conceal call commands for its function interceptors.
Using these function interceptors, the malicious programs modified process data which was processed in those two places, and returned control back.
Thus, the attackers change the normal execution of the server processes.
Unfortunately, the company was not able to share its targeted application with us, and we cannot say exactly how this malicious interference affected gaming processes.
The company concerned told us that the attackers’ aim was to acquire gaming “gold” illegally.
Malicious activity like this has an adverse impact on the game itself, tilting the balance in favor of cheats.
But any changes the Winnti team introduces into the game experience are unlikely to be very noticeable.
After all, maintaining a skillful balance is the main attribute of online games!
Users will simply stop playing if they feel that other players are using non-standard methods to create an advantage beyond normal gameplay or if the game loses its intrinsic competitiveness due to resources or artifacts appearing in the game without the developers’ knowledge.
At the same time the attackers are keen for the game to remain popular; otherwise, they would be unable to effectively turn all the time and effort of infecting a gaming company into financial gain.
Members of the Winnti team are patient and cautious.
Cybercriminals have affected the processes of the online games from the infected companies and stolen money from them for years, but they have found ways of doing this without attracting attention to themselves.
Source of Attacks
So, who is behind Winnti?
While analyzing the malicious files that we detected during our investigation we found some details which may cast some light on the source of the attacks.
As part of our investigation, we monitored exactly what the cybercriminals did on an infected PC.
In particular, they they downloaded an auxiliary program ff._exe to the Config.Msi folder on the infected machine.
This code searches for HTML, MS Excel, MS Word, Adobe, PowerPoint and MS Works documents and text files (.txt) on the hard drive.
Debugging lines were found in ff._exe_ that possibly point to the nationality of the cybercriminals.
They were not immediately noticeable because they looked like this in the editor:

However, during a detailed analysis it emerged that the text is in Chinese Simplified GBK coding.
This is a program with a Chinese interface.
Chinese text was also found in one of the components of the malicious program CmdPlus.dll plug-in:

Translation: The process is complete!!
It would appear that the attackers can at least speak Chinese.
This means the attackers were working on a Korean Windows operating system.
Therefore, we can presume that the attack is not the exclusive work of Chinese-speaking cybercriminals.
Conclusions
Our research revealed long-term oriented large scale cyberespionage campaign of a criminal group with Chinese origins.
These attacks are not new, many other security researchers have published details of various cybercriminal groups coming from China.
The malicious program which we call “Winnti” has evolved significantly since it first emerged; however we classify all its variants in two main generations: 1.x and 2.x.
We have published the technical description of the first generation of Winnti in a separate article .
The second generation (2.x) was used to conduct an attack which we investigated during its active stage.
We successfully prevented data transfer to the cybercriminals’ server and isolated the infected systems in the company’s local network.
The incidents, as well as results of our investigation, are described in the full report on the Winnti group (PDF).
In addition, we discovered that the Winnti group uses a popular backdoor known as PlugX which also has Chinese origins.
This backdoor had previously been seen almost exclusively in attacks targeting Tibetan activists.

This data demonstrates that the Winnti team is targeting gaming companies located in various parts of the world, albeit with a strong focus on SE Asia.
 Countries where gaming companies have been affected
Such geographic diversity is hardly surprising.
Often, gaming companies (both publishers and developers) are international, having representatives and offices worldwide.
Also, it is common practice for gaming companies from various regions to cooperate.
The developers of a game may be located in a different country from its publisher.
When a game later reaches markets in regions away from its initial ‘home’, it is often localized and published by other publishers.
In the course of this cooperation, the partner companies often grant each other access to network resources to exchange data associated with the gaming content, including distribution kits, gaming resources, resource assembly kits, etc.
If one company in the network gets infected, it’s easy for the cybercriminals to spread the infection throughout the partnership chain.
During the investigation, we identified over a hundred malicious programs, every single one compiled to attack a particular company.
Typically, separate C&C domains were assigned to each targeted company.
Virtually all the C&C domains were arranged as follows: a second-level domain was created without a DNS A-record, i.e., there was no IP address assigned to it.
In case there was an A-record, the assigned IP address was typically 127.0.0.1.
It is also noteworthy that some of the second-level domains that the cybercriminals created for their C&C had very similar names to the domain hosting the site of a certain real gaming company.
And the malicious users’ domain was resolved to the same IP address which the site of the real gaming company used.
In any case, the third-level domains resolved to IP addresses assigned to the attackers’ actual C&C servers.
C&C domain naming and resolution
Sometimes the Winnti team registered their C&C units with public hosts.
Judging by the samples identified, these C&C centers were subdomains of such domains as 6600.org, 8866.org, 9966.org or ddns.net.
From the names of the C&C domains or subdomains, the attack targets or countries of residence could be guessed, as in:
ru.gcgame.info
kr.zzsoft.info
jp.xxoo.co
us.nhntech.com
fs.nhntech.com
as.cjinternet.us
The subdomains “ru”, “kr”, “jp” and “us” most probably mean that these C&C servers manage bots hosted on the computers of companies located in Russia, South Korea, Japan and the US respectively, while “fs” and “as” are acronyms for the names of the companies being attacked.
Sometimes Winnti’s malicious programs had a local IP address, such as 192.168.1.136, specified in their settings for the C&C.
This could mean that at some point of time there was an infected computer that did not have a connection to the Internet, but the cybercriminals needed control over it (it may have been infected while malware was spread via a corporate network).
In this case, the cybercriminals deployed a dedicated local C&C server on another compromised computer within the same local network which did have an Internet connection; via that C&C, the first victim computer could be controlled.
System administrators often try to isolate critical computers from the outside world.
This decreases the probability of haphazard infection, but, apparently, does not always help in a targeted attack.
In the Winnti samples that were detected and analyzed, we found 36 unique C&C domains.
Most probably, this is only a small portion of all existing Winnti C&C domains, as we only managed to obtain some of the samples from this malware family.
This is hardly surprising since these malicious programs are used to execute targeted attacks, so no information is available about many instances of infection; for this reason, we have no way of obtaining samples of the malware used in these undisclosed attacks.
Having searched through subdomains for a total of 12 2nd level domains, we identified 227 “live” 3rd level domains.
Many of them are C&C servers for Winnti-class malware that have hitherto remained unidentified.
Their early domains were involved in spreading rogue antiviruses (FakeAV).
From 2009 onwards, domains began to emerge hosting C&C servers for bots used to infect gaming companies.
Apparently, the cybercriminals graduated to relatively large-scale penetrations into the corporate networks of gaming companies starting from 2010.
Known Malware
The attackers’ favorite tool is the malicious program we called “Winnti”.
It has evolved since its first use, but all variants can be divided into two generations: 1.x and 2.x.
Our publication describes both variants of this tool.
In our report we publish an analysis of the first generation of Winnti.
The second generation (2.x) was used in one of the attacks which we investigated during its active stage, helping the victim to interrupt data transfer and isolate infections in the corporate network.
This incident and our investigation is described in detail here.
In addition to that, we have observed the use of a popular backdoor known as PlugX, which is believed to have Chinese origins.
Previously, this had only been used in attacks against Tibetan activists.
The Commercial Interest
As has been stated above, APTs can target any commercial company if cybercriminals find a way to make a profit from the attack.
So which methods do cybercriminals use to generate illicit earnings from attacks on gaming companies?
Based on the available information, we have singled out three main monetization schemes that could be used by the Winnti team.
The unfair accumulation of in-game currency/”gold” in online games and the conversion of virtual funds into real money.
Theft of source code from the online games server to search for vulnerabilities in games – often linked to point 1.
Theft of source code from the server part of popular online games to further deploy pirate servers.
Let’s look at an example.
During our investigation of an infection at a computer game company, we found that malware had been created for a particular service on the company’s server.
The malicious program was looking for a specific process running on the server, injected code into it, and then sought out two places in the process code where it could conceal call commands for its function interceptors.
Using these function interceptors, the malicious programs modified process data which was processed in those two places, and returned control back.
Thus, the attackers change the normal execution of the server processes.
Unfortunately, the company was not able to share its targeted application with us, and we cannot say exactly how this malicious interference affected gaming processes.
The company concerned told us that the attackers’ aim was to acquire gaming “gold” illegally.
Malicious activity like this has an adverse impact on the game itself, tilting the balance in favor of cheats.
But any changes the Winnti team introduces into the game experience are unlikely to be very noticeable.
After all, maintaining a skillful balance is the main attribute of online games!
Users will simply stop playing if they feel that other players are using non-standard methods to create an advantage beyond normal gameplay or if the game loses its intrinsic competitiveness due to resources or artifacts appearing in the game without the developers’ knowledge.
At the same time the attackers are keen for the game to remain popular; otherwise, they would be unable to effectively turn all the time and effort of infecting a gaming company into financial gain.
Members of the Winnti team are patient and cautious.
Cybercriminals have affected the processes of the online games from the infected companies and stolen money from them for years, but they have found ways of doing this without attracting attention to themselves.
Source of Attacks
So, who is behind Winnti?
While analyzing the malicious files that we detected during our investigation we found some details which may cast some light on the source of the attacks.
As part of our investigation, we monitored exactly what the cybercriminals did on an infected PC.
In particular, they they downloaded an auxiliary program ff._exe to the Config.Msi folder on the infected machine.
This code searches for HTML, MS Excel, MS Word, Adobe, PowerPoint and MS Works documents and text files (.txt) on the hard drive.
Debugging lines were found in ff._exe_ that possibly point to the nationality of the cybercriminals.
They were not immediately noticeable because they looked like this in the editor:

However, during a detailed analysis it emerged that the text is in Chinese Simplified GBK coding.
This is a program with a Chinese interface.
Chinese text was also found in one of the components of the malicious program CmdPlus.dll plug-in:

Translation: The process is complete!!
It would appear that the attackers can at least speak Chinese.
This means the attackers were working on a Korean Windows operating system.
Therefore, we can presume that the attack is not the exclusive work of Chinese-speaking cybercriminals.
Conclusions
Our research revealed long-term oriented large scale cyberespionage campaign of a criminal group with Chinese origins.
These attacks are not new, many other security researchers have published details of various cybercriminal groups coming from China.
The malicious program which we call “Winnti” has evolved significantly since it first emerged; however we classify all its variants in two main generations: 1.x and 2.x.
We have published the technical description of the first generation of Winnti in a separate article .
The second generation (2.x) was used to conduct an attack which we investigated during its active stage.
We successfully prevented data transfer to the cybercriminals’ server and isolated the infected systems in the company’s local network.
The incidents, as well as results of our investigation, are described in the full report on the Winnti group (PDF).
In addition, we discovered that the Winnti group uses a popular backdoor known as PlugX which also has Chinese origins.
This backdoor had previously been seen almost exclusively in attacks targeting Tibetan activists.

Knowing the 2nd level domains used by Winnti, we brute forced through all 3rd level subdomains up to 4 symbols long, and identified those that have the IP addresses of real servers assigned to them.
Having searched through subdomains for a total of 12 2nd level domains, we identified 227 “live” 3rd level domains.
Many of them are C&C servers for Winnti-class malware that have hitherto remained unidentified.
Analyzing the WHOIS data for the 12 2nd level domains, we found the following list of email addresses used for registration:
evilsex@gmail.com
jslee.jcr@gmail.com
whoismydns@gmail.com
googl3@live.com
wzcc@cnkker.com
apanku2009@gmail.com
For some of these domains, registration data proved to be the same as those for the domain google.com:
Registrant: Google Inc.
1600 Amphitheatre Parkwa
Mountain Vie, California 94043
United States
+1.6503300100
Judging by the domain registration data, the Winnti team started their criminal activities at least in 2007.
Their early domains were involved in spreading rogue antiviruses (FakeAV).
From 2009 onwards, domains began to emerge hosting C&C servers for bots used to infect gaming companies.
Apparently, the cybercriminals graduated to relatively large-scale penetrations into the corporate networks of gaming companies starting from 2010.
The attackers’ favorite tool is the malicious program we called “Winnti”.
It has evolved since its first use, but all variants can be divided into two generations: 1.x and 2.x.
Our publication describes both variants of this tool.
In our report we publish an analysis of the first generation of Winnti.
The second generation (2.x) was used in one of the attacks which we investigated during its active stage, helping the victim to interrupt data transfer and isolate infections in the corporate network.
This incident and our investigation is described in detail here.
In addition to that, we have observed the use of a popular backdoor known as PlugX, which is believed to have Chinese origins.
Previously, this had only been used in attacks against Tibetan activists.
As has been stated above, APTs can target any commercial company if cybercriminals find a way to make a profit from the attack.
So which methods do cybercriminals use to generate illicit earnings from attacks on gaming companies?
Based on the available information, we have singled out three main monetization schemes that could be used by the Winnti team.
Let’s look at an example.
During our investigation of an infection at a computer game company, we found that malware had been created for a particular service on the company’s server.
The malicious program was looking for a specific process running on the server, injected code into it, and then sought out two places in the process code where it could conceal call commands for its function interceptors.
Using these function interceptors, the malicious programs modified process data which was processed in those two places, and returned control back.
Thus, the attackers change the normal execution of the server processes.
Unfortunately, the company was not able to share its targeted application with us, and we cannot say exactly how this malicious interference affected gaming processes.
The company concerned told us that the attackers’ aim was to acquire gaming “gold” illegally.
Malicious activity like this has an adverse impact on the game itself, tilting the balance in favor of cheats.
But any changes the Winnti team introduces into the game experience are unlikely to be very noticeable.
After all, maintaining a skillful balance is the main attribute of online games!
Users will simply stop playing if they feel that other players are using non-standard methods to create an advantage beyond normal gameplay or if the game loses its intrinsic competitiveness due to resources or artifacts appearing in the game without the developers’ knowledge.
At the same time the attackers are keen for the game to remain popular; otherwise, they would be unable to effectively turn all the time and effort of infecting a gaming company into financial gain.
Members of the Winnti team are patient and cautious.
Cybercriminals have affected the processes of the online games from the infected companies and stolen money from them for years, but they have found ways of doing this without attracting attention to themselves.
So, who is behind Winnti?
While analyzing the malicious files that we detected during our investigation we found some details which may cast some light on the source of the attacks.
As part of our investigation, we monitored exactly what the cybercriminals did on an infected PC.
In particular, they they downloaded an auxiliary program ff._exe to the Config.Msi folder on the infected machine.
This code searches for HTML, MS Excel, MS Word, Adobe, PowerPoint and MS Works documents and text files (.txt) on the hard drive.
Debugging lines were found in ff._exe_ that possibly point to the nationality of the cybercriminals.
They were not immediately noticeable because they looked like this in the editor:
However, during a detailed analysis it emerged that the text is in Chinese Simplified GBK coding.
This is what these lines look in Chinese:
Below is a machine translation of this text into English:
In addition, cybercriminals used the AheadLib program to create malicious libraries (for details, see the second part of the article).
This is a program with a Chinese interface.
Chinese text was also found in one of the components of the malicious program CmdPlus.dll plug-in:

Translation: The process is complete!
It would appear that the attackers can at least speak Chinese.
While monitoring the cybercriminals’ activity on the infected machine, we noticed they uploaded the certificate they found in the infected system, and the network traffic reflected the local path indicating the place where they saved the file on their computer:
These characters appear to be Korean, meaning “desktop”.
This means the attackers were working on a Korean Windows operating system.
Therefore, we can presume that the attack is not the exclusive work of Chinese-speaking cybercriminals.
Our research revealed long-term oriented large scale cyberespionage campaign of a criminal group with Chinese origins.
These attacks are not new, many other security researchers have published details of various cybercriminal groups coming from China.
However, current hacking group has distinguishable features that make it stand out among others:
The malicious program which we call “Winnti” has evolved significantly since it first emerged; however we classify all its variants in two main generations: 1.x and 2.x.
We have published the technical description of the first generation of Winnti in a separate article .
The second generation (2.x) was used to conduct an attack which we investigated during its active stage.
We successfully prevented data transfer to the cybercriminals’ server and isolated the infected systems in the company’s local network.
The incidents, as well as results of our investigation, are described in the full report on the Winnti group (PDF).
In addition, we discovered that the Winnti group uses a popular backdoor known as PlugX which also has Chinese origins.
This backdoor had previously been seen almost exclusively in attacks targeting Tibetan activists.
More than just a game
Your email address will not be published.
Required fields are marked *
 Save my name, email, and website in this browser for the next time I comment.
Notify me when new comments are added.
The hottest research right in your inbox
While investigating a recent rise of attacks against Exchange servers, we noticed a recurring cluster of activity that appeared in several distinct compromised networks.
With a long-standing operation, high profile victims, advanced toolset and no affinity to a known threat actor, we decided to dub the cluster GhostEmperor.
We discovered a campaign delivering the Tomiris backdoor that shows a number of similarities with the Sunshuttle malware distributed by DarkHalo APT and target overlaps with Kazuar.
This is our latest summary of advanced persistent threat (APT) activity, focusing on significant events that we observed during Q2 2021: attacks against Microsoft Exchange servers, APT29 and APT31 activities, targeting campaigns, etc.
We recently came across unusual APT activity that was detected in high volumes, albeit most likely aimed at a few targets of interest.
Further analysis revealed that the actor, which we dubbed LuminousMoth, shows an affinity to the HoneyMyte group, otherwise known as Mustang Panda.
The hottest research right in your inbox
© 2021 AO Kaspersky Lab.
Registered trademarks and service marks are the property of their respective owners.
The hottest research right in your inbox
