Defend against threats, ensure business continuity, and implement email policies.
Protect against email, mobile, social and desktop threats.
Engage your users and turn them into a strong line of defense against phishing and other cyber attacks.
Defend against cyber criminals accessing your sensitive data and trusted accounts.
Reduce risk, control costs and improve data visibility to ensure compliance.
Protect from data loss by negligent, compromised, and malicious users.
Protect against digital security risks across web domains, social media and the deep and dark web.
Get deeper insight with on-call, personalized assistance from our expert team.
  Get real-time insight into threats that can cause data loss and brand damage.
Protect your people from email and cloud threats with an intelligent and holistic approach
Help your employees identify, resist and report attacks before the damage is done
Prevent data loss via negligent, compromised and malicious insiders by correlating content, behavior and threats
Manage risk and data retention needs with a modern compliance and archiving solution
Keep your people and their cloud apps secure by eliminating threats, avoiding data loss and mitigating compliance risk
Implement the very best security and compliance solution for your Microsoft 365 collaboration suite
Secure access to corporate resources and ensure business continuity for your remote workers
Deliver Proofpoint solutions to your customers and grow your business.
Learn about the benefits of becoming a Proofpoint Extraction Partner.
Learn about our global consulting and services partners that deliver fully managed and integrated solutions.
Learn about our relationships with industry-leading firms to help protect your people, data and brand.
Learn about the technology and alliance partners in our Social Media Protection Partner program.
Small Business Solutions for channel partners and MSPs.
Find the information you're looking for in our library of videos, data sheets, white papers and more.
Keep up with the latest news and happenings in the ever‑evolving cybersecurity landscape.
Learn about the human side of cybersecurity.
Episodes feature insights from experts and executives.
Learn about the latest security threats and how to protect your people, data, and brand.
Connect with us at events to learn how to protect your people and data from ever‑evolving threats.
Read how Proofpoint customers around the globe solve their most pressing cybersecurity challenges.
Browse our webinar library to learn about the latest threats, trends and issues in cybersecurity.
Learn about our threat operations center and read about the latest risks in our threat blog and reports.
Proofpoint is a leading cybersecurity company that protects organizations' greatest assets and biggest risks: their people.
Today’s cyber attacks target people.
Learn about our unique people-centric approach to protection.
Stand out and make a difference at one of the world's leading cybersecurity companies.
Read the latest press releases, news stories and media highlights about Proofpoint.
Access the full range of Proofpoint support services.
Proofpoint researchers observed an interesting email campaign by a threat actor we track as TA800.
This actor has predominantly used BazaLoader since April of 2020, but on February 3rd, 2021 they distributed a new malware we are calling NimzaLoader.
One of NimzaLoader’s distinguishing features is that it is written in the Nim programming language.
Malware written in Nim are rare in the threat landscape.
Malware developers may choose to use a rare programming language to avoid detection, as reverse engineers may not be familiar with Nim’s implementation, or focused on developing detection for it, and therefore tools and sandboxes may struggle to analyze samples of it.
There has been some initial analysis of the malware on Twitter indicating that it may just be another variant of BazaLoader, of which there are many variants.
On March 1st, Joshua Platt and Jason Reaves from Walmart put forth an excellent writeup on this malware that they call Nimar Loader.
Our independent analysis corroborates their analysis and assertions that this malware is not a BazaLoader variant.
Some of the major differences between NimzaLoader and the BazaLoader variants that we’ve analyzed include:
In this post we’ll take a closer look at the email campaign and the malware.
On February 3rd, 2021, Proofpoint observed a TA800 campaign distributing NimzaLoader.
Consistent with previous activity, this campaign utilized personalized details in its lure, including, the recipient’s name and/or the company’s name.
The messages contained links, which in some cases were shortened links, purporting to be a link to a PDF preview, but instead linked to GetResponse (an email marketing service) landing pages.
The landing pages contained links to the “PDF” which was the NimzaLoader executable hosted on Slack and used a fake Adobe icon in an attempt to fool the user.
Figure 1: TA800 message linking to the GetResponse Landing Page
 Figure 2: TA800 GetResponse Landing page linking to the download of NimzaLoader
The sample with a SHA-256 hash of 540c91d46a1aa2bb306f9cc15b93bdab6c4784047d64b95561cf2759368d3d1d was reverse engineered for this analysis.
At the time of research, the C&C servers were already down, so we also made use of a PCAP file uploaded to VirusTotal.
NimzaLoader was developed using the Nim programming language.
This can be seen by the various “nim” related strings in the executable (Figure 3):
Figure 3: Example of Nim related strings
Most of the strings used by the malware are encrypted when stored by using an XOR-based algorithm and a single key per string.
An IDA Python function of the algorithm will be available on our GitHub.
Here is a listing of decrypted strings from the analyzed sample:
A few strings, mostly command names, are stored as stack strings instead of encrypted strings.
One of the encrypted strings is a Unix epoch timestamp and is used as an expiration date for the malware.
In the analyzed sample, the expiration date was set to “1612963255.0039535” (e.g., Wednesday, February 10, 2021 1:20:55.003 PM GMT) and the malware will not run after this date and time.
The C&C URLs are stored as encrypted strings and in the analyzed sample were the following:
There is also an encrypted string that contains a C&C URL path component used in command requests.
In the analyzed sample this component was “about”.
The initial beacon is called a “handshake” by the malware and an example looks like Figure 4:
 Figure 4: Example handshake request and response
The handshake is used to do a X2551 key exchange with the C&C server and retrieve some configuration items.
The “SID” value in the “Cookie” header request is base64 encoded.
Once decoded, it contains the malware’s generated public key for the key exchange and some additional data to decrypt the handshake response from the C&C server.
The C&C response can be decrypted by using this data along with some of the encrypted strings from the malware and some primitives from the Monocypher crypto library.
A Python snippet using data from the above referenced PCAP and its sample showing this decryption process will be available on our GitHub.
Once decrypted the response contains a JSON object that looks like Figure 5:
Figure 5: Example handshake response JSON object
It contains the following pieces:
The key shared between the malware and C&C server via the key exchange will be used for future C&C communications.
Unfortunately, we were unable to derive the shared key used in the referenced PCAP to decrypt further communication examples.
Future C&C URLs are constructed using the configuration item mentioned above and the received “path_adj” and “path_noun” components.
Here is an example C&C URL for the reference PCAP:
Updated “path_adj” and “path_noun” components are sent in successive C&C responses via a response header whose name is the previously set “path_noun”.
This mechanism can be seen in the red highlights of Figures 6 and 7 below.
Once the handshake is completed, the remaining C&C communications are command requests and command responses.
An example command request looks like Figure 6:
Figure 6: Example command request
In the command request, the Cookie header “SID” value changes to a bot identifier.
The response is encrypted using the shared key and once decrypted contains a JSON object.
It contains the following fields:
Once decoded, “job” contains another JSON object containing:
Commands will be detailed in the “Commands” section below.
An example command response looks like:
Figure 7: Example command response
Command responses are similar to requests and contain command outputs or error messages.
The following commands have been identified in NimzaLoader:
At the time of research, all known NimzaLoader C2s were already down, but a public malware sandbox run seems to show it receiving a “powershell” command that ultimately delivered a Cobalt Strike beacon.
We are unable to validate or confirm this finding, but it does align with past TA800 tactics, techniques, and procedures (TTPs).
NimzaLoader is a new initial access malware being distributed and used by the TA800 threat actor.
In 2020, we observed the shift from TA800 distributing the Trick, with intermittent shifts to Buer Loader, and a consistent distribution of Bazaloader since April 2020.
There has been some research community analysis suggesting that NimzaLoader is just another variant of BazaLoader, but based on our observations of significant differences, we are tracking this as a distinct malware family.
There has been some evidence suggesting NimzaLoader is being used to download and execute Cobalt Strike as its secondary payload, but it is unclear whether this is its primary purpose.
It is also unclear if Nimzaloader is just a blip on the radar for TA800—and the wider threat landscape—or if Nimzaloader will be adopted by other threat actors in the same way BazaLaoder has gained wide adoption.
TA800 continues to integrate different tactics into their campaigns, with the latest campaigns delivering Cobalt strike directly.
ETPRO TROJAN NimzaLoader Initial CnC Host Checkin
ETPRO TROJAN NimzaLoader CnC Activity M1
ETPRO TROJAN NimzaLoader CnC Activity M2
Subscribe to the Proofpoint Blog
Terms and conditions
Privacy Policy
Sitemap
