On Thursday 2021-07-08, for a short while when Hancitor was initially active, if any victims clicked on a malicious link from the malspam, they would receive a XLL file instead of a malicious Word doc.
I tried one of the email links in my lab and received the malicious XLL file.
After other researchers reported they were receiving Word documents, I tried a few hours later and received a Word document instead.

Shown above:  Flow chart for my first Hancitor infection on 2021-07-08.
Since November 2020, Hancitor has consistently followed specific patterns of infection activity, and my previous diary from January 2021 is typical of what I've seen.
Only one change has happened recently.
Since June 8th 2021, malicious spam (malspam) pushing Hancitor switched from docs.google.com links in their messages to using feedproxy.google.com URLs, which was initially reported by @James_inthe_box, @mesa_matt, and @executemalware.

Shown above:  Flow chart for my second Hancitor infection on 2021-07-08 (what I normally see).
I've also seen these Google feedproxy URLs used for Hancitor infections, but I had not seen the XLL files until now.
What is an XLL file?
XLL files are Excel add-in files.
They're DLL files specifically designed to be run by Microsoft Excel.
Think of an XLL file as an "Excel DLL."
As usual, emails for this wave of Hancitor used a DocuSign theme, and they spoofed cabanga[.
]com as the sending domain.
Just like in recent weeks, links went to a Google feedproxy URL.

Shown above:  Example of malspam pushing Hancitor from 2021-07-08.
The Google feedproxy URL leads to a malicious page on a compromised webite designed to send the initial malicious file and redirect the browser to DocuSign's website.
I've described the process here and here.
This process makes it appear as if the file was offered by DocuSign, when it was actually sent through a malicious web page.

Shown above:  The website for DocuSign appears in a victim's browser immediately after a malicious file is offered for download.
Remember, this malicious activity is not caused by DocuSign.
DocuSIgn is one of many companies that cybercriminals impersonate when distributing malware like Hancitor.
DocuSign is aware of this long-running effort by the criminals behind Hancitor, and the company has guidelines for dealing with this sort of malicious activity.
When opening the XLL file, Excel asks if you want to enable the add-in as shown below.

Shown above:  Opening the malicious XLL file in Excel.
The default option was to leave the add-in disabled.
But when I opened the XLL file in my lab enviornment, I enabled all code for the add-in.
Excel immediately ran the add-in and closed.
I didn't see any sort of fake template like we usually see when Hancitor uses a Word document as the initial file.
During my first infection run with the XLL file, most of the traffic followed known patterns for Hancitor and Cobalt Strike, I saw two additional URLs as noted below.

Shown above: Traffic from my first Hancitor infection filtered in Wireshark, with the two unusual URLs noted.
Thes two URLs returned files that were saved to my Windows client in the C:\Users\Public\ directory.
The first URL returned an HTML file that was saved as res32.hta.
That .hta file retrieved an EXE for Hancitor which was saved as snd32sys.exe.

Shown above:  HTML (.hta) and EXE files saved the Windows host.
Hancitor showed a build number of 0707in2_wvcr in C2 traffic caused by the EXE.
During my second infection run with a Hancitor DLL, I saw a build number of 0707_wvcr,

Shown above:  C2 traffic from Hancitor EXE during my first infection.

Shown above:  C2 traffic from Hancitor DLL during my second infection.
This Github page contains 35 Google feedproxy URLs and 35 associated URLs used to send the initial malicious file.
Traffic related to Ficker Stealer:
Traffic related to Cobalt Strike:
A pcap of the infection traffic from my first infection run (with the XLL file) can be found here.
Brad Duncan
brad [at] malware-traffic-analysis.net
