Three major campaigns using malicious spam (malspam) to distribute malware stopped sending malspam before Christmas-sometime during the week ending on Sunday 2018-12-23.
These three campaigns are Emotet (also known as Feodo), Hancitor (also known as Chanitor or Tordal), and Trickbot.
But this week, all three campaigns have been sending out malspam again.
Among these campaigns, Emotet is by far the most active.
Dozens of indicators are discovered every day as vectors for Emotet infections.
Emotet also acts a distributor for other families of malware.
So far in 2019, I’ve seen Emotet retrieve Gootkit and the IcedID banking Trojan.
As 2019 progresses, I expect to find examples of Emotet distributing other families of malware like Qakbot and Trickbot, something we saw in 2018.
Today’s diary examines recent Emotet malspam and two examples of infection traffic from Tuesday 2019-01-15.

Shown above:  Chain of events for Emotet malware distribution seen so far this year.
As usual, emails pushing Emotet use Microsoft Word documents with malicious macros.
On vulnerable Windows hosts, opening these documents in Microsoft Word and enabling macros will attempt an Emotet infection.
So far this week, Emotet malspam had a link to download the Word document, or it’s had a Word document directly attached to the email.
See the images below for examples.

Shown above:  Screenshot 1 of 3 - Emotet malspam with link for Word doc from Tuesday 2019-01-15.

Shown above:  Screenshot 2 of 3 - Emotet malspam with link for Word doc from Tuesday 2019-01-15.

Shown above:  Screenshot 3 of 3 - Emotet malspam with attached Word doc from Monday 2019-01-14.

Shown above:  Example of Word document with macro to infect a vulnerable Windows host with Emotet.
Network traffic is typical for what we’ve seen with recent Emotet infections from December 2018.
Emotet frequently uses HTTP traffic over non-standard TCP ports (not TCP port 80).
This may cause issues when reviewing the infection traffic in Wireshark.
Traffic on ports like TCP port 53 (associated with DNS activity like zone transfers) and TCP port 22 (normally associated with SSH) may not be decoded as HTTP in Wireshark.
That was the case with two examples of infection traffic I generated on Monday.
Post-infection activity from the first run included Gootkit, which had similar in traffic patterns that I’ve previously documented.
Post-infection activity from the second run included IcedID (also known as Bokbot), something I’ve also documented.
The following are indicators from two infections on Tuesday 2019-01-15.
Any malicious URLs, IP addresses, and domain names have been “de-fanged” to avoid issues when viewing today’s diary.
Malware from the first run:
Malware from the second run:
Emotet Infection traffic from the first run:
Gootkit infection traffic from the first run:
Emotet infection traffic from the second run:
IcedID infection traffic from the second run:
Pcaps of the infection traffic and malware associated with today's diary can be found here.
---
Brad Duncan
brad [at] malware-traffic-analysis.net
Sign Up for Free or Log In to start participating in the conversation!
Follow the Internet Storm Center on Twitter
