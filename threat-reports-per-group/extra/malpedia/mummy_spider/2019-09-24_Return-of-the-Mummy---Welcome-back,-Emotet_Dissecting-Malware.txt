Tue 24 September 2019 in Banking-Malware
Or to be more historically precise: Imhotep was the Egyptian, Emotet is the Malware strain we are going to take a Look at.
Last week it returned from its summer vacation with a few new tricks
Emotet Sample #1 @ Hybrid Analysis
--> sha256 6076e26a123aaff20c0529ab13b2c5f11259f481e43d62659b33517060bb63c5
Emotet Sample #2 @ Hybrid Analysis
--> sha256 757b35d20f05b98f2c51fc7a9b6a57ccbbd428576563d3aff7e0c6b70d544975
Emotet brought home a few souveniers from summer trip as well.
The image above and below show the two most common decoy header pictures that the distributed Maldocs use.
To hide the malicious VBA code that hides under the picture they used small textboxes that contain the embedded macro.
#Emotet malspam campaign uses Snowdenâ€™s new book as lurehttps://t.co/J2W6RvKWxC pic.twitter.com/p9v5yox4sEâ€” MB Threat Intel (@MBThreatIntel) September 23, 2019
#Emotet malspam campaign uses Snowdenâ€™s new book as lurehttps://t.co/J2W6RvKWxC pic.twitter.com/p9v5yox4sE
As Researchers at MalwareBytes found out the malspammers are even trying to lure people into downloading the infected Word Documents by advertising them as Edward Snowden's new Book "Permanent Record".
Seems like the criminals reached a new moralic low point.
The following two screenshots are excerpts of the report generated by OLETools on an Emotet Word Document.
After decoding the Base64 String we get this command as a result:
Taking a peek at the Imports we can see that the Malware uses (amongst other functions) TerminateProcess, IsDebuggerPresent and GetTimeZoneInfo imported from Kernel32.dll.
Furthermore it also imports various functions like RegDeleteValueW to modify the registry from Advapi32.dll.
It uses the IsDebuggerPresent function out of debugapi.h to check if it is actively being debugged and will exit if it returns true.

The Any.Run Analysis of the second sample can be found here.
Looks like we stumbled across a real Typography expert as well ðŸ˜¹
Sounds like another attempt to frame / disguise as another executable.

Interesting strings all around ðŸ¤”
Another quite interesting tool to unpack and analyze Emotet is tracecorn_tina, which is (as the name might already suggest) based on tracecorn, a Windows API tracer for malware.
My Name is Marius Genheimer aka f0wL and I'm a Computer Science Student from Germany.
As you can probably tell I like to analyse malware (especially Ransomware) in my spare time.
A searchable database of E-Mail addresses used in Ransomnotes plus facts and analysis
Some of my Blogposts are listed on Malpedia, an invaluable resource for Malware Research.
Marius Genheimer 2019-2020 | https://f0wl.cc | Stay safe and always encrypt your offsite backups :)
Theme mg by Luca Chiricozzi.
