We're building value and opportunity by investing in cybersecurity, analytics, digital solutions, engineering and science, and consulting.
Our culture of innovation empowers employees as creative thinkers, bringing unparalleled value for our clients and for any problem we try to tackle.
Empower People to Change the World®
Review and search for open jobs in Japan, Korea, Guam, Hawaii, and Alaska and support governments across the world.
We’d love to meet you.
Find upcoming Booz Allen recruiting & networking events near you.
Find out how veterans can pursue careers in AI, cloud, and cyber.
As a values-driven company, we make a difference in communities where we live and work.
Learn how we cultivate a culture of inclusion and celebrate the diverse backgrounds and experiences of our employees.
Learn how we’re driving empowerment, innovation, and resilience to shape our vision for the future through a focus on environmental, social, and governance (ESG) practices that matter most.
Each year, we celebrate the client engagements, leading ideas, and talented people that support our success.
Our latest global events, including webinars and in-person, live events and conferences.
The hardest problems aren’t solved in one lab or studio.
We pull from our diverse partner program to address each client’s unique mission requirements to drive the best outcomes.
Our 28,600 engineers, scientists, software developers, technologists, and consultants live to solve problems that matter.
We’re proud of the diversity throughout our organization, from our most junior ranks to our board of directors and leadership team.
Written by Jay Novak and Matthew Pennington
As previously reported, researchers observed APT34, a hacker group, using BONDUPDATER (downloader) and POWRUNER (backdoor).
Pivoting from these known indicators, Booz Allen’s DarkLabs' Threat Hunt team performed a deep dive analysis and found an additional 3 malware variants and associated network infrastructure that are a potential threat to organizations worldwide.
Booz Allen’s DarkLabs Threat Hunt team developed an advanced technique that pivots on open source indicators of compromise (IOC) to discover new variants of Malware.
The life cycle of an openly reported IOC does not end when an operator deploys the indicator to a sensor or a threat hunter checks their security information and event manager (SIEM).
Merging the IOC with internal or external raw sources of cyber threat intelligence reveals additional IOCs and malware variants.
Additional indicators, robust detection, and advanced analytics can work together to stop threat actors in their tracks.
Booz Allen's DarkLabs  Threat Hunt team exercised a combination of open-source reporting and acquired sources of threat intelligence, then merged this information with our own internally developed tools to expand and perform deep analysis on previously reported APT34 behaviors.
In early December 2017, FireEye released a report discussing recent activity, which they attributed to APT34.
APT34 is a group that is thought to be involved in nation state cyber espionage since at least 2014.
The FireEye report references binary (MD5: C9F16F0BE8C77F0170B6CE876ED7FB) which is a loader for both BONDUPDATER, the downloader, and POWRUNER, the backdoor.
This loader connects to a known Command and Control (C2) domain, proxycheker[.]pro.
Using this binary as a starting point, our DarkLabs team of Threat Hunters discovered three additional binaries that appear to be associated with APT34 activity.

          This unique adware’s advanced behavior is typically only seen in attacks attributed to nation-state APTs.
The first two samples were found using a custom tool developed by DarkLabs’ Threat Hunt Team.
This tool extracts a binary’s metadata, such as creation date or filename, and automatically searches VirusTotal for any potentially related malware variants.
If any matches are found, the associated files are pulled so our threat hunters can reverse engineer or perform static and dynamic malware analysis to determine if the samples are variants of the initial binary.
When we ran the initial binary through our tool, it returned two potentially related binaries.
By analyzing the three binaries together, we discovered unique debug strings that flagged in all three samples.
This type of comparative analysis highlights the common functions used by the developer and where any changes to defeat detection may have been implemented.
Using these discovered similarities, we performed a VirusTotal Intelligence (VTI) retrohunt (searching back in time for malware – signature match) which uses a YARA rule to search previously submitted files in VTI, within a recent limited timeframe.
The retrohunt yielded the discovery of a fourth binary.
The three new variants of the FireEye reported binary all exhibit similar behavior.
Each binary creates, runs, and deletes rUpdateChecker.ps1 in the C:\ProgramData\Windows\Microsoft\java\ staging directory.
That PowerShell file also creates a VBScript and the Scheduled Tasks entry to run the VBScript script every minute.
All versions of rUpdateChecker.ps1 contained the POWRUNER backdoor, but not all had the BONDUPDATER downloader script.
There were also other differences between the various binaries that are discussed below.
The POWRUNER backdoor can execute arbitrary code and exfiltrate data via simple command and control over TCP.
Relationship between original binary and three discovered variants.
(Use the scrollbar to view the content on the far right.)
As you can see from Table 1 above, these files exhibit many similar characteristics and behaviors.
Most of the differences appear to be cosmetic and do not affect the underlying functionality.
Our analysts took a closer look at the C2 domain poison-frog[.
]club, which is used in 3 of the 4 files, and found that it overlaps with the findings of the FireEye report.
The domain resolved to 82.102.14.219 from at least August 2017 until December 2017.
Additional domains that resolved to that IP during that time frame are dns-update[.
]com which were all mentioned in the FireEye report.
The other C2 domain used, proxycheker[.
]pro, resolved to 94.23.172.164 and 185.15.247.147, with 185.15.247.147 also hosting dns-update[.
]club during that time frame.
This new-found evidence, in combination with similar versions of POWRUNER and BONDUPDATER, the existence of the same debug strings in the code of each variant, and the overlapping infrastructure indicate that these three new binaries are also associated with APT34 operations.
The DGA domain generation algorithm used in one version of the BONDUPDATER backdoor is broken down into two parts: send and receive.
If data is being sent, then the following format is used:
If data is being received, then the following format is used:
The Domain Generating Algorithm (DGA) generation process is different than what was previously mentioned in the FireEye report.
However, it would still be detected using DarkLabs' custom DGA detection mechanism.
In early January 2018, ClearSky Cyber Security tweeted about two new malware samples attributed to Oilrig/APT34.
These samples were being deployed via a malicious .chm (Compiled HTML Help File) file.
ClearSky provides a link to a Google document they use for "Raw Threat Intelligence" which contained additional IOCs associated with this campaign.
Two hashes provided in that document are for versions of POWRUNER (MD5: BED81E58EF8FF0B073E371D433A08855) and BONDUPDATER (MD5: 63D6B1933F7330358A8FBFAF77532133).
These two backdoors contain a reference to another C2 domain, www.window5[.]win.
Using the custom tool developed in DarkLabs, we were able to pivot from these samples and discover an additional sample each of POWRUNER and BONDUPDATER.
These two new samples exhibit similar behavior to the samples mentioned in the FireEye report.
However, there are a few slight differences - namely the use of a new C2 domain and URI, www.window5[.]win/update.aspx.
At writing time of this post, that domain resolves to 185.181.8.246.
Current research indicates that IP does not host any other domains publicly available.
Additionally, the %PUBLIC%\Java location (e.g.
C:\Users\Public\Java) is used for a staging directory in this version of POWRUNER.
Relationship between original two samples and two discovered variants.
(Use the scrollbar to view the content on the far right.)
Dropper of POWRUNER and BONDUPDATER
Dropper of POWRUNER and BONDUPDATER
Dropper of POWRUNER and BONDUPDATER
Scheduled Task to run VBS script
Sets up scheduled task to deploy POWRUNER
Scheduled Task to run VBS script
Sets up scheduled task to deploy POWRUNER and BONDUPDATER
Scheduled Task to run VBS script
Sets up scheduled task to deploy POWRUNER and BONDUPDATER
Scheduled Task to run VBS script
Sets up scheduled task to deploy POWRUNER and BONDUPDATER
Yara Signature for the dropper
Use the scrollbar to view the content on the far right.
By diving deeper and pivoting on known indicators using techniques developed and honed by our experienced analysts, the indicator lifecycle can diversify discovery.
In this case, analysts discovered additional unreported, yet campaign associated IOCs that can be used for further detection.
Additionally, our analysts also developed YARA signatures for static detection, and TTP based signatures to deploy to EDR tools or for hunting through endpoint telemetry data.
The Booz Allen DarkLabs Threat Hunt team recommends deploying detection to endpoints for the hashes listed above and perform a retroactive search for the domains and IPs in SIEM logs.
We also recommend the use of telemetry data collected via EDR tools to continuously hunt for this behavior.
Monitoring for the behavior or TTP is a critical step because although IOCs can be used for detection and discovery, they can in many cases be changed cheaply and easily.
Our advanced Threat Hunt team always recommends a robust proactive approach to threat hunting with a focus on behavioral detection.
Please contact us if you would like to learn more about DarkLabs Threat Hunt team, or if you are interested in joining our team.

          Get tips on how to identify a new, sophisticated adware variant, and learn what to do if you find it in your network.

          Our ability to recruit and retain top-tier cyber talent allows us to build teams with the true diversity of skill sets required to overcome our clients’ toughest, most specialized cybersecurity challenges.

          This unique adware’s advanced behavior is typically only seen in attacks attributed to nation-state APTs.
