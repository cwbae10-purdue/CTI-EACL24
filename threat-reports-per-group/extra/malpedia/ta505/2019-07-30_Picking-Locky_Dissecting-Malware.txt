Tue 30 July 2019 in Ransomware
Back in 2016 Locky was (one of) the first to commercialize the "art" of holding data for ransom.
I picked this strain because I would like a bit more of a challenge in terms of obfuscation and anti-disassembly techniques, so strap in for this OG Ransomware
Locky (at least the first few versions) is said to be created by the makers of the Dridex/Cridex banking trojans.
For example the spreading mechanism via macros in Word or Excel documents sent out via carefully crafted spear-phishing emails is exactly the same for both of these strains.
Locky #1 available @ https://github.com/ytisf/theZoo/tree/master/malwares/Binaries/Ransomware.Locky
sha256 bc98c8b22461a2c2631b2feec399208fdc4ecd1cd2229066c2f385caa958daa3
Locky.AZ available @ https://dasmalwerk.eu/
sha256 2e4319ff62c03a539b2b2f71768a0cfc0adcaedbcca69dbf235081fe2816248b






Running this first Locky Sample was pretty unspectacular since nothing really happend ðŸ¤”.
Let's take a look at the binary first:



Would you look at that!
We found ourselves some poor mans obfuscation :D A whole bunch of random strings to make the analyst's life just a little bit harder.
We'll come back to this later to see if we can simplify our strings output a bit.
After a couple of seconds it spawns a new svchost.exe process with the same icon as Locky.exe had previously.
Of course we'll dump the process memory to a file (just right-click the listing in Process Hacker and choose Create dump from the context menu).
Looking at the properties of the new svchost.exe process we can see that it is actually run from C:\Users\IEUser\AppData\Local\Temp\ and it's unsigned as well.
This article is a work in progress, updates going to follow soon
My Name is Marius Genheimer aka f0wL and I'm a Computer Science Student from Germany.
As you can probably tell I like to analyse malware (especially Ransomware) in my spare time.
A searchable database of E-Mail addresses used in Ransomnotes plus facts and analysis
Some of my Blogposts are listed on Malpedia, an invaluable resource for Malware Research.
Marius Genheimer 2019-2020 | https://f0wl.cc | Stay safe and always encrypt your offsite backups :)
Theme mg by Luca Chiricozzi.
