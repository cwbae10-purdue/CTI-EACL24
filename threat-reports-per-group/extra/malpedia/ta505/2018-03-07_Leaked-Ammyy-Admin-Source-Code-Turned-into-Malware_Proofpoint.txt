Defend against threats, ensure business continuity, and implement email policies.
Protect against email, mobile, social and desktop threats.
Engage your users and turn them into a strong line of defense against phishing and other cyber attacks.
Defend against cyber criminals accessing your sensitive data and trusted accounts.
Reduce risk, control costs and improve data visibility to ensure compliance.
Protect from data loss by negligent, compromised, and malicious users.
Protect against digital security risks across web domains, social media and the deep and dark web.
Get deeper insight with on-call, personalized assistance from our expert team.
  Get real-time insight into threats that can cause data loss and brand damage.
Protect your people from email and cloud threats with an intelligent and holistic approach
Help your employees identify, resist and report attacks before the damage is done
Prevent data loss via negligent, compromised and malicious insiders by correlating content, behavior and threats
Manage risk and data retention needs with a modern compliance and archiving solution
Keep your people and their cloud apps secure by eliminating threats, avoiding data loss and mitigating compliance risk
Implement the very best security and compliance solution for your Microsoft 365 collaboration suite
Secure access to corporate resources and ensure business continuity for your remote workers
Deliver Proofpoint solutions to your customers and grow your business.
Learn about the benefits of becoming a Proofpoint Extraction Partner.
Learn about our global consulting and services partners that deliver fully managed and integrated solutions.
Learn about our relationships with industry-leading firms to help protect your people, data and brand.
Learn about the technology and alliance partners in our Social Media Protection Partner program.
Small Business Solutions for channel partners and MSPs.
Find the information you're looking for in our library of videos, data sheets, white papers and more.
Keep up with the latest news and happenings in the ever‑evolving cybersecurity landscape.
Learn about the human side of cybersecurity.
Episodes feature insights from experts and executives.
Learn about the latest security threats and how to protect your people, data, and brand.
Connect with us at events to learn how to protect your people and data from ever‑evolving threats.
Read how Proofpoint customers around the globe solve their most pressing cybersecurity challenges.
Browse our webinar library to learn about the latest threats, trends and issues in cybersecurity.
Learn about our threat operations center and read about the latest risks in our threat blog and reports.
Proofpoint is a leading cybersecurity company that protects organizations' greatest assets and biggest risks: their people.
Today’s cyber attacks target people.
Learn about our unique people-centric approach to protection.
Stand out and make a difference at one of the world's leading cybersecurity companies.
Read the latest press releases, news stories and media highlights about Proofpoint.
Access the full range of Proofpoint support services.
Proofpoint researchers have discovered a previously undocumented remote access Trojan (RAT) called FlawedAmmyy that has been used since the beginning of 2016 in both highly targeted email attacks as well as massive, multi-million message campaigns.
Narrow attacks targeted the Automotive industry among others, while the large malicious spam campaigns appear to be associated with threat actor TA505, an actor responsible for many large-scale attacks since at least 2014.
FlawedAmmyy Admin appeared most recently as the payload in massive email campaigns on March 5 and 6, 2018.
The messages in these campaigns contained zipped .url attachments and both the messages and the delivery suggest they were sent by threat actor TA505, known for sending  large-scale Dridex, Locky, and GlobeImposter campaigns, among others, over the last four years.
For example, on March 5, the messages were sent from addresses spoofing the recipient’s own domain with subjects such as “Receipt No 1234567” (random digits, and first word could also be “Bill” or “Invoice”) and matching attachments "Receipt 1234567.zip".
The attachments were ZIP archives containing ".url" files with names such as "B123456789012.url".
Again, these were apparently random digits (Figure 1).
Figure 1: Sample email from March 5, 2018, Ammyy Admin malware campaign
Figure 2: Contents of the .url file
The .url files are interpreted by Microsoft Windows as “Internet Shortcut” files [1], examples of which can be found in the “Favorites” folder on Windows operating systems.
This type of file can be created manually [2]; they are intended to serve as links to internet sites, launching the default  browser automatically.
However, in this case the attacker specified the URL to be a “file://” network share instead of the typical http:// link.
As a result, the system downloads and executes a JavaScript file over the SMB protocol rather than launching a web browser if the user clicks “Open” on the warning dialog shown in Figure 3.
Figure 3: Warning dialog displayed after double-clicking the .url file
This JavaScript in turn downloads Quant Loader, which, in this case, fetched the FlawedAmmyy RAT as the final payload.
The use of “.url” files and SMB protocol downloads is unusual, and this is the first time we have seen these methods combined.
The FlawedAmmyy RAT previously appeared on March 1 in a narrowly targeted attack.
Emails contained an attachment 0103_022.doc (Figure 4), which used macros to download the FlawedAmmyy malware directly.
This sample used the same command and control (C&C) address as the sample from the massive campaign on March 5.
Figure 4: Screenshot of the document attachment from March 1, 2018, FlawedAmmyy campaign
We also observed this RAT in a narrowly targeted attack that included the automotive industry.
Emails contained the attachment 16.01.2018.doc which used macros to download the FlawedAmmyy RAT directly.
FlawedAmmyy is based on leaked source code for Version 3 of the Ammyy Admin remote desktop software.
As such FlawedAmmyy contains the functionality of the leaked version, including:
Figure 5: Strings from the analyzed January 16 sample contain references to the leaked Ammyy Admin Version 3
Figure 6: Snippet of Ammyy Admin Version 3 source code, file TrMain.cpp
The FlawedAmmyy C&C protocol occurs over port 443 with HTTP.
In the initial handshake, sent by the client to the server, the first byte is always “=”, followed by 35 obfuscated and SEAL-encrypted bytes.
After a server response (0x2d00), the infected client sends the second packet.
This packet has a 5-byte header that includes the length of the rest of the packet (0x78).
The body of this packet contains cleartext key-value pairs:
Figure 7: Screenshot of FlawedAmmyy C&C protocol from Wireshark
Table 1: Explanation of the key-value pairs sent by the infected client in the second packet
8 digit number, the first digit always being ‘5’ and the remaining 7 chosen at random on initialization of the malware
Antivirus product name obtained via WMI query
1 if a usable smart-card is inserted into a reader, 0 otherwise
Malware build time, obtained at runtime by reading the PE timestamp field from its file on disk
Ammyy Admin is a popular remote access tool used by businesses and consumers to handle remote control and diagnostics on Microsoft Windows machines.
However, leaked source code for Version 3 of Ammyy Admin has emerged as a Remote Access Trojan called FlawedAmmyy appearing in a variety of malicious campaigns.
For infected individuals, this means that attackers potentially have complete access to their PCs, giving threat actors the ability to access a variety of services, steal files and credentials, and much more.
We have seen FlawedAmmyy in both massive campaigns, potentially creating a large base of compromised computers, as well as targeted campaigns that create opportunities for actors to steal customer data, proprietary information, and more.
SMB URL contained in the Internet Shortcut
List of code-signing Certificates used:
00 BB AE 27 7A C3 D9 CF 3F 85 00 86 A3 14 E7 0A D7
7F 6B 67 8E 66 DD 35 D6 58 9D 9B B2 0F C3 BA 0B
25 43 BF D0 26 6A 5C ED A6 63 9A 2A 49 15 75 3A
10 88 E7 1C 82 F9 BB 73 74 7C 6D 0B 75 E0 5F 17
00 A0 71 DB B3 2B 9D E4 F8 D2 17 39 44 C3 C2 39 F9
ET and ETPRO Suricata/Snort Coverage
2025408 | Win32/FlawedAmmyy RAT CnC Checkin
2024452 | ET TROJAN Quant Loader v1.45 Download Request
2023203 | ET TROJAN Quant Loader Download Request
Subscribe to the Proofpoint Blog
Terms and conditions
Privacy Policy
Sitemap
