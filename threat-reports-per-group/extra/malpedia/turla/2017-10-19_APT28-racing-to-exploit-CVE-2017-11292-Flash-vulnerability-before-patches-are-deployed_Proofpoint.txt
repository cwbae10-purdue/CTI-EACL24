Defend against threats, ensure business continuity, and implement email policies.
Protect against email, mobile, social and desktop threats.
Engage your users and turn them into a strong line of defense against phishing and other cyber attacks.
Defend against cyber criminals accessing your sensitive data and trusted accounts.
Reduce risk, control costs and improve data visibility to ensure compliance.
Protect from data loss by negligent, compromised, and malicious users.
Protect against digital security risks across web domains, social media and the deep and dark web.
Get deeper insight with on-call, personalized assistance from our expert team.
  Get real-time insight into threats that can cause data loss and brand damage.
Protect your people from email and cloud threats with an intelligent and holistic approach
Help your employees identify, resist and report attacks before the damage is done
Prevent data loss via negligent, compromised and malicious insiders by correlating content, behavior and threats
Manage risk and data retention needs with a modern compliance and archiving solution
Keep your people and their cloud apps secure by eliminating threats, avoiding data loss and mitigating compliance risk
Implement the very best security and compliance solution for your Microsoft 365 collaboration suite
Secure access to corporate resources and ensure business continuity for your remote workers
Deliver Proofpoint solutions to your customers and grow your business.
Learn about the benefits of becoming a Proofpoint Extraction Partner.
Learn about our global consulting and services partners that deliver fully managed and integrated solutions.
Learn about our relationships with industry-leading firms to help protect your people, data and brand.
Learn about the technology and alliance partners in our Social Media Protection Partner program.
Small Business Solutions for channel partners and MSPs.
Find the information you're looking for in our library of videos, data sheets, white papers and more.
Keep up with the latest news and happenings in the ever‑evolving cybersecurity landscape.
Learn about the human side of cybersecurity.
Episodes feature insights from experts and executives.
Learn about the latest security threats and how to protect your people, data, and brand.
Connect with us at events to learn how to protect your people and data from ever‑evolving threats.
Read how Proofpoint customers around the globe solve their most pressing cybersecurity challenges.
Browse our webinar library to learn about the latest threats, trends and issues in cybersecurity.
Learn about our threat operations center and read about the latest risks in our threat blog and reports.
Proofpoint is a leading cybersecurity company that protects organizations' greatest assets and biggest risks: their people.
Today’s cyber attacks target people.
Learn about our unique people-centric approach to protection.
Stand out and make a difference at one of the world's leading cybersecurity companies.
Read the latest press releases, news stories and media highlights about Proofpoint.
Access the full range of Proofpoint support services.
This post will be updated as the threat is mitigated with additional C&C takedowns; for now we are only sharing basic information related to this campaign to avoid enabling actions by other threat actors.
We have already included new IOCs following initial takedown operations and will continue to monitor and engage in mitigation efforts.
On Tuesday, October 18, Proofpoint researchers detected a malicious Microsoft Word attachment exploiting a recently patched Adobe Flash vulnerability, CVE-2017-11292.
We attributed this attack to APT28 (also known as Sofacy), a Russian state-sponsored group.
Targeting data for this campaign is limited but some emails were sent to foreign government entities equivalent to the State Department and private-sector businesses in the aerospace industry.
The known geographical targeting appears broad, including Europe and the United States.
The emails were sent from free email services.
As we examined the document exploitation chain, we found that DealersChoice.B [2], the attack framework that the document uses, is now also exploiting CVE-2017-11292, a Flash vulnerability that can lead to arbitrary code execution across Windows, Mac OS, Linux, and Chrome OS systems.
The vulnerability was announced and patched on Monday, October 16 [1].
At that time Kaspersky attributed the exploit use to the BlackOasis APT group, which is distinct from APT28.
We suspect that APT28, who also possess this exploit (whether purchased, discovered on their own, or reverse engineered from the BlackOasis attack), may now seek to benefit from it as quickly as possible before the patch is widely deployed.
Thus, while this exploit is no longer a zero-day, this is only the second known campaign utilizing it reported in public.
APT28 burned their CVE-2017-0262 EPS 0-day in a similar fashion in April after Microsoft pushed an EPS exploit mitigation, which significantly reduced the impact of this exploit.
The document “World War 3.docx” contacts DealersChoice.B, APT28’s attack framework that allows loading exploit code on-demand from a command and control (C&C) server.
DealersChoice has previously been used to exploit a variety of Flash vulnerabilities, including CVE-2015-7645, CVE-2016-1019, CVE-2016-4117, and CVE-2016-7855 via embedded objects in crafted Microsoft Word documents.
Figure 1:  Decoy document used
This malicious document embeds the same Flash object twice in an ActiveX control for an unknown reason, although this is likely an operational mistake.
The Flash files work in the same manner as the last known attack using this tool: the embedded Flash decompresses a second Flash object that handles the communication with the exploit delivery server.
The only difference is that this second Flash object is no longer stored encrypted.
There are other signs that this campaign was devised hastily: for example, the actors did not change the decryption algorithm constants as they have in the past.
These particular constants were already used in a late December 2016 campaign.
Each document uses a different domain for victim exploitation, while the communication protocol with the server stayed the same as well.
Figure 2: Comparison of the decryption functions (lightly edited for readability) showing that the decryption algorithm constants were not changed
We performed testing and found exploitation to be successful on:
At this point, despite the potential impact across operating systems of this particular Flash vulnerability, Mac OS does not appear to be targeted by this campaign.
Users running 64-bit versions of Microsoft Office 2016 and Windows 10 RS3 should be protected against this exploit as well.
Figure 3: Flash 27.0.0.159 exploited by DealersChoice‘s CVE-2017-11292 on Windows 7 via Microsoft Office 2013
Figure 4: DealersChoice Flash checkin under Windows 10 build 1607, Microsoft Word 2013, and Flash 27.0.0.130
The CVE-2017-11292 exploit (Figure 5) delivered by the server is then decrypted and executed by the Flash object handling the communications.
Upon successful execution, the payload is requested, decrypted, and executed on the target system.
Figure 5: Use of the vulnerable mediacore.BufferControlParameters class
After exploitation, DealersChoice typically delivers a stage 1 implant named Uploader [4].
In this case, it delivered only the Uploader payload component (build 0x2125181f) without the intermediate dropper.
This malware has basic capabilities used for reconnaissance on the target systems.
Uploader is also used to deploy further tools and implants on the system.
It is worth noting that the timestamp (Wed Oct 18 01:54:28 2017 GMT) present in in the payload indicates a very short delay between the setup of this attack and its launch.
APT28 appears to be moving rapidly to exploit this newly documented vulnerability before the available patch is widely deployed.
Because Flash is still present on a high percentage of systems and this vulnerability affects all major operating systems, it is critical that organizations and end users apply the Adobe patch immediately.
APT28 is a sophisticated state-sponsored group that is using the vulnerability to attack potentially high-value targets but it is likely that other threat actors will follow suit and attempt to exploit this vulnerability more widely, whether in exploit kits or via other attack vectors.
DealersChoice C&C (now taken down)
DealersChoice C&C (now taken down)
DealersChoice C&C (now taken down)
ET and ETPRO Suricata/Snort Signatures
2014726 || ET POLICY Outdated Flash Version M1
2823078 || ETPRO TROJAN APT28 DealersChoice CnC Beacon M1
2823642 || ETPRO TROJAN APT28 DealersChoice CnC Beacon Response
2023916 || ET TROJAN APT28 Uploader Variant CnC Beacon
2828341 || ETPRO TROJAN APT28 DealersChoice DNS Lookup
2828342 || ETPRO TROJAN APT28 Uploader DNS Lookup
Subscribe to the Proofpoint Blog
Terms and conditions
Privacy Policy
Sitemap
