May 19, 2021 at 4:00 PM
Tags: BazaCall, BazaLoader, Bazar, BazarCall, BazarLoader, malware
This post is also available in: 
    日本語 (Japanese)
BazarLoader (sometimes referred to as BazaLoader) is malware that provides backdoor access to an infected Windows host.
After a client is infected, criminals use this backdoor access to send follow-up malware, scan the environment and exploit other vulnerable hosts on the network.
The threat actor behind BazarLoader uses different methods to distribute this malware to potential victims.
In early February 2021, researchers began reporting a call center-based method of distributing BazarLoader.
This method utilizes emails with a trial subscription-based theme that encourages potential victims to call a phone number.
A call center operator then answers and directs victims to a website to unsubscribe from the service.
Call center operators offer to personally guide victims through a process designed to infect vulnerable computers with BazarLoader.
An example of the process can be found in this YouTube video.
This call center-based process of infecting computers with BazarLoader has been dubbed the "BazarCall" method (sometimes referred to as "BazaCall" method).
Palo Alto Networks Next-Generation Firewall customers are protected from this threat with a Threat Prevention security subscription.
BazarCall infections follow a distinct pattern of activity.
See Figure 1 for a flow chart showing the chain of events.
Chain of Events for an Infection Using the BazarCall Method:
These emails state that the victim’s trial subscription is ending, and the victim’s credit card will be charged.
Phone numbers in these emails change at least daily, and occasionally we have seen two or more numbers appear during a single day.
A video has been posted on YouTube documenting someone posing as a victim and having a center operator guide them through the fake unsubscription process.
We contacted this call center on at least five different occasions, and the operator was a different person each time.
All operators were seemingly non-native English speakers.
Two of the operators were female, and three were male.
Each operator followed the same basic script, but there were variations.
The following conversation took place on Wednesday, April 14, 2021 using a phone number from the email shown below in Figure 2.
How may I help you?
I got an email today from a company called Paradise Books.
It says I have a subscription, and my credit card will be charged.
But I've never dealt with Paradise Books.
I don't remember doing anything or going to a website for Paradise Books or anything like that.
Do you have a subscription number?
[Note: The last 9 digits of this number are purposely not shown here because this number identifies the recipient's email address.]
Operator: Okay, I can repeat that back to you.
Operator: Yes sir, just hold on a moment let me check our system.
It seems this account was opened by John Edwards, but your email starts with [victim's first name].
Victim: Yes, I'm [victim's first name].
I don't know any John Edwards.
You'll need to cancel the subscription.
So what you need to do is go to worldbooks dot US.
Operator: Worldbooks [states each letter phonetically] dot US.
Victim: Hold on a second.
Let me get that in my web browser.
Can I read it back again?
It looks like it's loading.
Operator: Have you seen the website yet?
Victim: Okay, here we go.
So I've got a web page.
I've never seen this site before.
We can just cancel the subscription.
What you need is your subscriber number that you told me earlier.
Operator: Can you see the subscribe button?
Operator: When you click on that, you should be able to see unsubscribe.
Victim: Okay, I'm clicking the subscribe button.
Operator: Can you see unsubscribe?
Victim: I see a line that says, "Do you want to unsubscribe?"
Operator: That is where you need to go.
Operator: And then you enter the subscription number.
Operator: Once you do that, you will receive a confirmation document.
Victim: Okay, it's asking me what do I want to do with subscription 16184 something XLSB?
Operator: That is the confirmation document.
That's where you have your confirmation code.
Victim: Should I open it?
Operator: You can open it, if you need the confirmation.
The confirmation code is important.
In case anything happens, you can call us and give us the confirmation code.
Operator: So we can solve the issue.
Operator: Did you get it?
I'm opening it right now.
I see Excel Office 365.
Previewing is not available for protected documents.
I have to press enable.
Operator: Click editing and enable content.
[pauses] It shows a form with a company name, first name, last name, birthdate, and all that stuff.
Operator: Okay, can you see the code?
The code is the important one.
Victim: I don't see a code, no.
Can you see the next page?
Victim: Where is this code supposed to be?
Operator: There is a confirmation code in case you don't want to get charged but in case you get charged, that is what you call us with in order to cancel the charge.
Victim: Okay, I still don't know where I'm supposed to find this code.
Operator: Just hold on and let me check with the department of IT.
[hold music for approximately 1 minute]
Operator: I've checked with the IT department, and they are saying that the cancellation went through correctly.
We are just having an issue with our servers, but the cancellation went through successfully.
Operator: So nothing will be charged to your account.
And they've given me a code on their end.
Can I read it to you?
Operator: The code is [spells out seven characters of an alpha-numeric code].
Operator: In case of any problem, you can just call back and give us that code.
We will be able to resolve any issue.
And if you call back, you can ask for [operator's first name], because we have many [garbled].
[Victim repeats operator's first name]
Operator: Yes, that's my name.
Victim: Alright, well thank you.
Operator: Have a good day.
After macros are enabled on the downloaded Excel file, the BazarLoader DLL is dropped, and it generates a URL containing the string campo.
This type of URL is called Campo Loader, which acts as a gateway that redirects traffic to malware.
Some examples of Campo Loader URLs generated by a BazarLoader DLL are shown below in Table 1.
Recent Campo Loader URLs generated by BazarCall spreadsheet macros.
Figure 9 shows a Campo Loader URL from April 14, 2021 redirecting to a URL for BazarLoader.
Examples of recent URLs for BazarLoader EXE files are shown below in Table 2.
Recent URLs for BazarLoader malware.
The BazarLoader executable generates HTTPS C2 traffic noted below in Figure 10.
This section describes forensics on an infected Windows host from April 14, 2021.
SHA256 hash for the downloaded spreadsheet is:
Macros from the downloaded Excel file create artifacts in the Windows computer’s C:\Users\Public directory as shown in Figure 11.
File information is shown below in Table 3.
The first two are text files with the same SHA256 hash.
The other file is a BazarLoader DLL.
Artifacts from a BazarCall spreadsheet seen on April 14, 2021.
130486.xlsb and 130486.dot consist of an American Standard Code For Information Interchange (ASCII) string with base64 text.
This text represents the BazarLoader dynamic link library (DLL) file.
Macro code from the downloaded Excel file converts the base64 text to a DLL named 130486.pgj and runs this DLL using the following script commands:
Keep in mind these files are from one specific example.
Artifacts generated from other spreadsheets have different names and different file extensions.
The DLL is designed to retrieve a BazarLoader EXE.
In our example from April 14, 2021, the BazarLoader EXE was saved to a folder under the C:\ProgramData directory as shown below in Figure 12.
BazarLoader provides backdoor access to an infected Windows host.
In some cases, Cobalt Strike is seen as follow-up malware, leading to other malware like Anchor.
At least two cases have been publicly documented where BazarLoader malware led to Cobalt Strike and then to Anchor malware.
One case happened in February 2021, and the other case happened in March 2021.
However, BazarLoader is not limited to just Cobalt Strike and Anchor as follow-up malware.
2020 saw reports of BazarLoader leading to ransomware like Ryuk.
Backdoor access to an infected Windows host could lead to any family of malware.
As early as February 2021, we have seen several reports of the BazarCall method distributing BazarLoader malware using call center personnel.
These infections follow noticeable patterns, and they can lead to other malware like Cobalt Strike, Anchor and Ryuk ransomware.
Organizations with decent spam filtering, proper system administration and up-to-date Windows hosts have a much lower risk of infection from BazarLoader malware and its post-infection activity.
Palo Alto Networks Next-Generation Firewall customers are further protected from this threat with a Threat Prevention security subscription.
Palo Alto Networks has shared our findings, including file samples and indicators of compromise described in this report, with our fellow Cyber Threat Alliance (CTA) members.
CTA members use this intelligence to rapidly deploy protections to their customers and to systematically disrupt malicious cyber actors.
For more information on the Cyber Threat Alliance, visit www.cyberthreatalliance.org.
Examples of BazarCall emails (March and April 2021): GitHub repository.
Examples of domains hosting the fake websites used for the BazarCall method (March and April 2021): GitHub repository.
96 examples of Excel spreadsheets from unsubscribe pages from fake websites using the BazarCall method (March and April 2021): GitHub repository.
11 examples of BazarLoader DLL files dropped by Excel spreadsheet macros (March and April 2021): GitHub repository.
SHA256 hashes for 24 examples of BazarLoader EXE files retrieved by BazarLoader (March and April 2021): GitHub repository.
Sign up to receive the latest news, cyber threat intelligence and research from us
Please enter your email address!
Please mark, I'm not a robot!
By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.
© 2021 Palo Alto Networks, Inc. All rights reserved.
