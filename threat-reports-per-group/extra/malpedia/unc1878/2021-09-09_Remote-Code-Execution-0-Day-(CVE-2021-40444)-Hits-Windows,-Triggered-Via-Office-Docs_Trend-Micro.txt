Microsoft has disclosed the existence of a new zero-day vulnerability that affects multiple versions of Windows.
This vulnerability (designated as CVE-2021-40444) is currently delivered via malicious Office 365 documents and requires user input to open the file to trigger.
By: Trend Micro
		
			September 09, 2021
Read time:Â  ( words)
Microsoft has disclosed the existence of a new zero-day vulnerability that affects multiple versions of Windows.
This vulnerability (designated as CVE-2021-40444) is currently delivered via malicious Office 365 documents and requires user input to open the file to trigger.
It should be noted that by default, Office documents downloaded from the internet are opened either in Protected View or Application Guard, both of which would mitigate this particular attack.
If the attacker is able to convince the victim to download the file and bypass any mitigation, it would trigger the vulnerability and cause a malicious file to be downloaded and run on the affected machine.
Currently, this vulnerability is used to deliver Cobalt Strike payloads.
Microsoft has issued an official bulletin covering this vulnerability.
This blog entry discusses how the exploit may work, as well as Trend Micro solutions.
We have obtained multiple samples of documents that exploit this vulnerability.
The documents all contain the following code in the document.xml.rels file in their package:
Note the presence of a URL (which we have removed) that downloads a file titled side.html (SHA-256: d0fd7acc38b3105facd6995344242f28e45f5384c0fdf2ec93ea24bfbc1dc9e6).
This file contained obfuscated JavaScript; the image in Figure 2 shows part of the deobfuscated code.
Several actions can be seen in this code: it downloads a .CAB file, extracts a .DLL file from the said .CAB file, and uses path traversal attacks to run the file (which is named championship.inf).
Eventually, this leads to the execution of the championship.inf file, as seen below:
This payload is a Cobalt Strike beacon (SHA-256: 6eedf45cb91f6762de4e35e36bcb03e5ad60ce9ac5a08caeb7eda035cd74762b), which we detect as Backdoor.Win64.COBEACON.OSLJAU.
As is typically the case with Cobalt Strike, this could allow an attacker to take control of the affected system.
The malicious Office files are detected as Trojan.W97M.CVE202140444.A, with the malicious .CAB file detected as Trojan.Win64.COBEACON.SUZ.
As we noted earlier, Microsoft has yet to release an official patch.
We reiterate our long-standing advice to avoid opening files from unexpected sources, which could considerably lower the risk of this threat as it requires the user to actually open the malicious file.
We will update this post as necessary if more information becomes available.
Updates on Trend Micro solutions can be found on this knowledge base page.
