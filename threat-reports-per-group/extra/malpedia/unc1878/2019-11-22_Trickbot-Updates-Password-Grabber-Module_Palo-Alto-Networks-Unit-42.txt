November 22, 2019 at 12:25 PM
This post is also available in: 
    日本語 (Japanese)
First seen in 2016, Trickbot is malware that steals system information, login credentials, and other sensitive data from vulnerable Windows hosts.
Trickbot is a modular malware, and one of its modules is a password grabber.
In November 2019, we started seeing indicators of Trickbot's password grabber targeting data from OpenSSH and OpenVPN applications.
A Windows host infected with Trickbot downloads different modules to perform various functions.
These modules are stored as encrypted binaries in a folder located under the infected user’s AppData\Roaming directory.
The encrypted binaries are decoded as DLL files and run from system memory.
Figure 1 shows encoded Trickbot modules generated by a recent Trickbot infection on a 64-bit Windows 7 host from Friday November 8th, 2019.
Modules from a Trickbot infection on November 8th, 2019.
As seen in Figure 1, one of the modules is named pwgrab64.
This is a password grabber used by Trickbot.
This module retrieves login credentials stored in a victim's browser cache, and it also obtains login credentials from other applications installed on a victim’s host.
The password grabber and some other Trickbot modules send stolen data using unencrypted HTTP over TCP port 8082 to an IP address used by Trickbot.
For example, Figure 2 shows information from a packet capture (pcap) of traffic generated by a host infected with Trickbot.
It highlights an example of login credentials stolen from an infected user’s Chrome browser cache.
Note how the URL in the HTTP POST request ends with the number 81.
This number is used in URLs generated by Trickbot's password grabber module.
Login credentials stolen from an infected user’s Chrome browser cache.
Traffic patterns from recent Trickbot infections had been fairly consistent until early November 2019, when we started seeing two new HTTP POST requests caused by the password grabber.
For the OpenVPN line, configsls might be a misspelling of configs.
Figure 3 and Figure 4 show examples of HTTP POST requests that contain these identifiers.
HTTP POST request caused by Trickbot's password grabber for OpenSSH private keys.
HTTP POST request caused by Trickbot's password grabber for OpenVPN passwords and configurations.
These updates to Trickbot's password grabber module may not be fully functional.
HTTP POST requests caused by the password grabber for OpenSSH and OpenVPN occur whether or not the victim's host has OpenSSH or OpenVPN installed.
And we have not seen this traffic contain any actual data.
We generated Trickbot infections in lab environments for both Windows 7 and Windows 10 hosts with configured OpenSSH and OpenVPN applications.
However, we have not seen any working results.
HTTP POST requests generated by the password grabber for OpenSSH and OpenVPN during these infections contained no data.
However, Trickbot’s password grabber works will grab SSH passwords and private keys from an SSH/Telnet client named PuTTY.
Figure 5 and Figure 6 shows password grabber activity from a Trickbot-infected host with PuTTY installed and configured to use a private key for an SSH connection to a cloud server.
HTTP POST request caused by Trickbot's password grabber for PuTTY passwords.
HTTP POST request caused by Trickbot's password grabber for private keys used by PuTTY.
This blog post documents recent changes in Trickbot traffic patterns that indicate updates to its password grabber module.
These updates appear to target data from OpenSSH and OpenVPN applications, but this functionality does not appear to work.
Regardless, Trickbot's password grabber will grab sensitive data like private keys from SSH-related applications like PuTTY.
These updated traffic patterns demonstrate Trickbot continues to evolve.
However, best security practices like running fully-patched and up-to-date versions of Microsoft Windows will hinder or stop Trickbot infections.
Palo Alto Networks customers are further protected from Trickbot by our threat prevention platform.
AutoFocus users can track Trickbot activity by using the Trickbot tag.
Sign up to receive the latest news, cyber threat intelligence and research from us
Please enter your email address!
Please mark, I'm not a robot!
By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.
© 2021 Palo Alto Networks, Inc. All rights reserved.
