MD5:   b9501109bd94ac243f22aec5aca65aceSHA1: b2b2a14983b13f966b3bfeb2ba33c3dd64a69ded       SHA256: a3c4cb110064086fd7491d9cf5ffd7552384916c92effca20c8b16dfc625f37b
PlugX is a RAT (Remote Access Trojan) malware family that is around since 2008 and is used as a backdoor to fully control the victim's machine.
Once the machine is infected, a cybercriminal can remotely execute several kinds of commands on the affected system.
), manage Windows registry entries, open a shell, etc.
The malware also logs its own events in a text log file, probably in an attempt to enhance itself.
This sample is a Windows Self-Extracting Archive that contains a legitimate PDF document file along with the malware dropper (a regular PE32 executable file for MS Windows).
Once executed, the sample extracts the PDF document and the dropper file to the temp folder:
The malware then opens and displays the legitimate PDF document, making the victim believe that this is the only content and purpose of the self-extracting file:
Right after that, the dropper file is executed.
It drops the following files on the affected system:
And creates a new instance of %WINDIR%\system32\svchost.exe (Windows generic host process for services that run from dynamic-link libraries), which creates an instance of %WINDIR%\system32\msiexec.exe (Windows installer component).
The dropper then executes %ALLUSERSPROFILE%\SxSi\rc.exe, a clean and legitimate signed executable file - which loads %ALLUSERSPROFILE%\SxSi\rcdll.dll, a malicious dynamic-link library used as a loader.
The loader decrypts the encrypted payload in the malicious binary file %ALLUSERSPROFILE%\SxSi\rc.hlp and injects it in both newly created %WINDIR%\system32\svchost.exe and %\system32\msiexec.exe processes.
As result, malicious code is injected and running in system processes:
Once running, the malware creates a hidden log file to trace information and errors during its execution, probably in an attempt by the authors to enhance it:
It is worth to mention that malware installation procedures, filenames, locations and other details may vary depending on the analyzed sample.
The malware installs itself as a Windows service and is configured to automatically start during Windows startup (start type equals to “2”) to make itself persistent:
HKLM\SYSTEM\ControlSet001\Services\SxSi\ImagePath: ""C:\Documents and Settings\All Users\SxSi\rc.exe" 200 0"
HKLM\SYSTEM\CurrentControlSet\Services\SxSi\ImagePath: ""C:\Documents and Settings\All Users\SxSi\rc.exe" 200 0"
To protect the dropped files, the malware installs itself as a hidden Windows service/driver:
As result, the malware will run as a service and automatically start during Windows startup, however the victim will not be able to see it in the list of running services.
The malware also drops three files, including a legitimate signed executable files that loads the encrypted malicious code, thus making it difficult to be detected by AV.
Finally, the malware keeps all its related files encrypted while in the disk, only being unencrypted in the memory when injected in system processes, making it difficult to be detected by static analysis tools.
The malware spreads through phishing attacks by email containing malicious attachments.
The malware can communicate to the server using TCP, UDP and HTTP protocols.
Data sent to the server is encrypted.
The malware also uses GET and POST requests as following:
User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1)
User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1)
User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1)
User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1)
User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1)
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0)
More details can be found here.
